{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "config": {
    "axis": {
      "labelFontSize": 14,
      "labelFontWeight": 300,
      "titleFontSize": 16,
      "titleFontWeight": 400,
      "titlePadding": 10
    },
    "concat": {
      "spacing": 0
    },
    "legend": {
      "labelFontSize": 14,
      "labelFontWeight": 300,
      "orient": "top",
      "padding": 20,
      "symbolSize": 500.0,
      "symbolType": "circle",
      "titleFontSize": 16,
      "titleFontWeight": 400
    },
    "title": {
      "anchor": "start",
      "fontSize": 18,
      "fontWeight": 400,
      "subtitlePadding": 10
    },
    "view": {
      "continuousHeight": 300,
      "continuousWidth": 400,
      "stroke": null
    }
  },
  "spacing": 20,
  "title": {
    "fontSize": 20,
    "fontWeight": 500,
    "subtitle": [
      "Story & Data: https://covariants.org/shared-mutations",
      "Altair-based UpSet Plot: https://github.com/hms-dbmi/upset-altair-notebook"
    ],
    "subtitleColor": "#3A3A3A",
    "subtitleFontSize": 14,
    "text": "Shared Mutations of COVID Variants"
  },
  "vconcat": [
    {
      "hconcat": [
        {
          "encoding": {
            "color": {
              "field": "set",
              "scale": {
                "domain": [
                  "Alpha",
                  "Beta",
                  "Gamma",
                  "Delta",
                  "Eta",
                  "Iota",
                  "Kappa",
                  "Lambda",
                  "Mu",
                  "Omicron"
                ],
                "range": [
                  "#5778a4",
                  "#e49444",
                  "#d1615d",
                  "#85b6b2",
                  "#6a9f58",
                  "#e7ca60",
                  "#a87c9f",
                  "#f1a2a9",
                  "#967662",
                  "#b8b0ac"
                ]
              },
              "title": null,
              "type": "nominal"
            },
            "opacity": {
              "value": 1
            },
            "x": {
              "aggregate": "sum",
              "axis": {
                "grid": false,
                "tickCount": 3
              },
              "field": "count",
              "title": "Set Size",
              "type": "quantitative"
            },
            "y": {
              "axis": {
                "domain": false,
                "grid": false,
                "labels": false,
                "ticks": false
              },
              "field": "set_order",
              "title": null,
              "type": "nominal"
            }
          },
          "mark": {
            "size": 20,
            "type": "bar"
          },
          "selection": {
            "selector000": {
              "bind": "legend",
              "fields": [
                "set"
              ],
              "type": "multi"
            }
          },
          "transform": [
            {
              "aggregate": [
                {
                  "as": "count",
                  "field": "count",
                  "op": "sum"
                }
              ],
              "groupby": [
                "Alpha",
                "Beta",
                "Gamma",
                "Delta",
                "Eta",
                "Iota",
                "Kappa",
                "Lambda",
                "Mu",
                "Omicron"
              ]
            },
            {
              "as": "degree",
              "calculate": "(isDefined(datum['Alpha']) ? datum['Alpha'] : 0)+(isDefined(datum['Beta']) ? datum['Beta'] : 0)+(isDefined(datum['Gamma']) ? datum['Gamma'] : 0)+(isDefined(datum['Delta']) ? datum['Delta'] : 0)+(isDefined(datum['Eta']) ? datum['Eta'] : 0)+(isDefined(datum['Iota']) ? datum['Iota'] : 0)+(isDefined(datum['Kappa']) ? datum['Kappa'] : 0)+(isDefined(datum['Lambda']) ? datum['Lambda'] : 0)+(isDefined(datum['Mu']) ? datum['Mu'] : 0)+(isDefined(datum['Omicron']) ? datum['Omicron'] : 0)"
            },
            {
              "as": [
                "set",
                "is_intersect"
              ],
              "fold": [
                "Alpha",
                "Beta",
                "Gamma",
                "Delta",
                "Eta",
                "Iota",
                "Kappa",
                "Lambda",
                "Mu",
                "Omicron"
              ]
            },
            {
              "filter": "(datum['degree'] !== 0)"
            },
            {
              "filter": "(datum['is_intersect'] === 1)"
            },
            {
              "filter": {
                "selection": "selector000"
              }
            },
            {
              "filter": {
                "selection": "selector000"
              }
            },
            {
              "frame": [
                null,
                0
              ],
              "sort": [
                {
                  "field": "set_order"
                }
              ],
              "window": [
                {
                  "as": "set_order",
                  "field": "set",
                  "op": "distinct"
                }
              ]
            },
            {
              "frame": [
                null,
                null
              ],
              "window": [
                {
                  "as": "intersection_id",
                  "field": "",
                  "op": "row_number"
                }
              ]
            },
            {
              "from": {
                "fields": [
                  "set_abbre"
                ],
                "key": "set"
              },
              "lookup": "set"
            },
            {
              "from": {
                "fields": [
                  "set_order"
                ],
                "key": "set"
              },
              "lookup": "set"
            },
            {
              "groupby": [
                "intersection_id",
                "count"
              ],
              "op": "max",
              "pivot": "set",
              "value": "is_intersect"
            }
          ],
          "width": 300
        },
        {
          "layer": [
            {
              "encoding": {
                "color": {
                  "condition": {
                    "selection": {
                      "selector000": "selector002"
                    },
                    "value": "#3A3A3A"
                  },
                  "value": "#EA4667"
                },
                "tooltip": [
                  {
                    "aggregate": "max",
                    "field": "count",
                    "title": "Cardinality",
                    "type": "quantitative"
                  },
                  {
                    "field": "degree",
                    "title": "Degree",
                    "type": "quantitative"
                  }
                ],
                "x": {
                  "axis": {
                    "domain": false,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "intersection_id",
                  "sort": {
                    "field": "count",
                    "order": "ascending"
                  },
                  "title": null,
                  "type": "nominal"
                },
                "y": {
                  "axis": {
                    "domain": false,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "set_order",
                  "title": null,
                  "type": "nominal"
                }
              },
              "height": 280.0,
              "mark": {
                "opacity": 1,
                "size": 200,
                "type": "circle"
              },
              "selection": {
                "selector000": {
                  "bind": "legend",
                  "fields": [
                    "set"
                  ],
                  "type": "multi"
                },
                "selector001": {
                  "fields": [
                    "intersection_id"
                  ],
                  "on": "mouseover",
                  "type": "single"
                }
              },
              "transform": [
                {
                  "aggregate": [
                    {
                      "as": "count",
                      "field": "count",
                      "op": "sum"
                    }
                  ],
                  "groupby": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "as": "degree",
                  "calculate": "(isDefined(datum['Alpha']) ? datum['Alpha'] : 0)+(isDefined(datum['Beta']) ? datum['Beta'] : 0)+(isDefined(datum['Gamma']) ? datum['Gamma'] : 0)+(isDefined(datum['Delta']) ? datum['Delta'] : 0)+(isDefined(datum['Eta']) ? datum['Eta'] : 0)+(isDefined(datum['Iota']) ? datum['Iota'] : 0)+(isDefined(datum['Kappa']) ? datum['Kappa'] : 0)+(isDefined(datum['Lambda']) ? datum['Lambda'] : 0)+(isDefined(datum['Mu']) ? datum['Mu'] : 0)+(isDefined(datum['Omicron']) ? datum['Omicron'] : 0)"
                },
                {
                  "as": [
                    "set",
                    "is_intersect"
                  ],
                  "fold": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "filter": "(datum['degree'] !== 0)"
                },
                {
                  "filter": "(datum['is_intersect'] === 1)"
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "frame": [
                    null,
                    0
                  ],
                  "sort": [
                    {
                      "field": "set_order"
                    }
                  ],
                  "window": [
                    {
                      "as": "set_order",
                      "field": "set",
                      "op": "distinct"
                    }
                  ]
                },
                {
                  "frame": [
                    null,
                    null
                  ],
                  "window": [
                    {
                      "as": "intersection_id",
                      "field": "",
                      "op": "row_number"
                    }
                  ]
                },
                {
                  "from": {
                    "fields": [
                      "set_abbre"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "from": {
                    "fields": [
                      "set_order"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "groupby": [
                    "intersection_id",
                    "count"
                  ],
                  "op": "max",
                  "pivot": "set",
                  "value": "is_intersect"
                }
              ],
              "width": 900
            },
            {
              "encoding": {
                "color": {
                  "condition": {
                    "selection": {
                      "selector000": "selector002"
                    },
                    "value": "#3A3A3A"
                  },
                  "value": "#EA4667"
                },
                "tooltip": [
                  {
                    "aggregate": "max",
                    "field": "count",
                    "title": "Cardinality",
                    "type": "quantitative"
                  },
                  {
                    "field": "degree",
                    "title": "Degree",
                    "type": "quantitative"
                  }
                ],
                "x": {
                  "axis": {
                    "domain": false,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "intersection_id",
                  "sort": {
                    "field": "count",
                    "order": "ascending"
                  },
                  "title": null,
                  "type": "nominal"
                },
                "y": {
                  "axis": {
                    "domain": false,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "set_order",
                  "title": null,
                  "type": "nominal"
                }
              },
              "height": 280.0,
              "mark": {
                "opacity": 1,
                "size": 200,
                "type": "circle"
              },
              "transform": [
                {
                  "aggregate": [
                    {
                      "as": "count",
                      "field": "count",
                      "op": "sum"
                    }
                  ],
                  "groupby": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "as": "degree",
                  "calculate": "(isDefined(datum['Alpha']) ? datum['Alpha'] : 0)+(isDefined(datum['Beta']) ? datum['Beta'] : 0)+(isDefined(datum['Gamma']) ? datum['Gamma'] : 0)+(isDefined(datum['Delta']) ? datum['Delta'] : 0)+(isDefined(datum['Eta']) ? datum['Eta'] : 0)+(isDefined(datum['Iota']) ? datum['Iota'] : 0)+(isDefined(datum['Kappa']) ? datum['Kappa'] : 0)+(isDefined(datum['Lambda']) ? datum['Lambda'] : 0)+(isDefined(datum['Mu']) ? datum['Mu'] : 0)+(isDefined(datum['Omicron']) ? datum['Omicron'] : 0)"
                },
                {
                  "as": [
                    "set",
                    "is_intersect"
                  ],
                  "fold": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "filter": "(datum['degree'] !== 0)"
                },
                {
                  "filter": "(datum['is_intersect'] === 1)"
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "frame": [
                    null,
                    0
                  ],
                  "sort": [
                    {
                      "field": "set_order"
                    }
                  ],
                  "window": [
                    {
                      "as": "set_order",
                      "field": "set",
                      "op": "distinct"
                    }
                  ]
                },
                {
                  "frame": [
                    null,
                    null
                  ],
                  "window": [
                    {
                      "as": "intersection_id",
                      "field": "",
                      "op": "row_number"
                    }
                  ]
                },
                {
                  "from": {
                    "fields": [
                      "set_abbre"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "from": {
                    "fields": [
                      "set_order"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "groupby": [
                    "intersection_id",
                    "count"
                  ],
                  "op": "max",
                  "pivot": "set",
                  "value": "is_intersect"
                }
              ],
              "width": 900
            },
            {
              "encoding": {
                "color": {
                  "condition": {
                    "selection": {
                      "selector000": "selector002"
                    },
                    "value": "#3A3A3A"
                  },
                  "value": "#EA4667"
                },
                "tooltip": [
                  {
                    "aggregate": "max",
                    "field": "count",
                    "title": "Cardinality",
                    "type": "quantitative"
                  },
                  {
                    "field": "degree",
                    "title": "Degree",
                    "type": "quantitative"
                  }
                ],
                "x": {
                  "axis": {
                    "domain": true,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "intersection_id",
                  "sort": {
                    "field": "count",
                    "order": "ascending"
                  },
                  "title": null,
                  "type": "nominal"
                },
                "y": {
                  "aggregate": "min",
                  "field": "set_order",
                  "type": "nominal"
                },
                "y2": {
                  "aggregate": "max",
                  "field": "set_order"
                }
              },
              "height": 420.0,
              "mark": {
                "color": "#3A3A3A",
                "size": 2,
                "type": "bar"
              },
              "transform": [
                {
                  "aggregate": [
                    {
                      "as": "count",
                      "field": "count",
                      "op": "sum"
                    }
                  ],
                  "groupby": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "as": "degree",
                  "calculate": "(isDefined(datum['Alpha']) ? datum['Alpha'] : 0)+(isDefined(datum['Beta']) ? datum['Beta'] : 0)+(isDefined(datum['Gamma']) ? datum['Gamma'] : 0)+(isDefined(datum['Delta']) ? datum['Delta'] : 0)+(isDefined(datum['Eta']) ? datum['Eta'] : 0)+(isDefined(datum['Iota']) ? datum['Iota'] : 0)+(isDefined(datum['Kappa']) ? datum['Kappa'] : 0)+(isDefined(datum['Lambda']) ? datum['Lambda'] : 0)+(isDefined(datum['Mu']) ? datum['Mu'] : 0)+(isDefined(datum['Omicron']) ? datum['Omicron'] : 0)"
                },
                {
                  "as": [
                    "set",
                    "is_intersect"
                  ],
                  "fold": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "filter": "(datum['degree'] !== 0)"
                },
                {
                  "filter": "(datum['is_intersect'] === 1)"
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "frame": [
                    null,
                    0
                  ],
                  "sort": [
                    {
                      "field": "set_order"
                    }
                  ],
                  "window": [
                    {
                      "as": "set_order",
                      "field": "set",
                      "op": "distinct"
                    }
                  ]
                },
                {
                  "frame": [
                    null,
                    null
                  ],
                  "window": [
                    {
                      "as": "intersection_id",
                      "field": "",
                      "op": "row_number"
                    }
                  ]
                },
                {
                  "from": {
                    "fields": [
                      "set_abbre"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "from": {
                    "fields": [
                      "set_order"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "groupby": [
                    "intersection_id",
                    "count"
                  ],
                  "op": "max",
                  "pivot": "set",
                  "value": "is_intersect"
                }
              ],
              "width": 900
            },
            {
              "encoding": {
                "color": {
                  "value": "#E6E6E6"
                },
                "tooltip": [
                  {
                    "aggregate": "max",
                    "field": "count",
                    "title": "Cardinality",
                    "type": "quantitative"
                  },
                  {
                    "field": "degree",
                    "title": "Degree",
                    "type": "quantitative"
                  }
                ],
                "x": {
                  "axis": {
                    "domain": false,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "intersection_id",
                  "sort": {
                    "field": "count",
                    "order": "ascending"
                  },
                  "title": null,
                  "type": "nominal"
                },
                "y": {
                  "axis": {
                    "domain": false,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "set_order",
                  "title": null,
                  "type": "nominal"
                }
              },
              "height": 280.0,
              "mark": {
                "opacity": 1,
                "size": 200,
                "type": "circle"
              },
              "transform": [
                {
                  "aggregate": [
                    {
                      "as": "count",
                      "field": "count",
                      "op": "sum"
                    }
                  ],
                  "groupby": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "as": "degree",
                  "calculate": "(isDefined(datum['Alpha']) ? datum['Alpha'] : 0)+(isDefined(datum['Beta']) ? datum['Beta'] : 0)+(isDefined(datum['Gamma']) ? datum['Gamma'] : 0)+(isDefined(datum['Delta']) ? datum['Delta'] : 0)+(isDefined(datum['Eta']) ? datum['Eta'] : 0)+(isDefined(datum['Iota']) ? datum['Iota'] : 0)+(isDefined(datum['Kappa']) ? datum['Kappa'] : 0)+(isDefined(datum['Lambda']) ? datum['Lambda'] : 0)+(isDefined(datum['Mu']) ? datum['Mu'] : 0)+(isDefined(datum['Omicron']) ? datum['Omicron'] : 0)"
                },
                {
                  "as": [
                    "set",
                    "is_intersect"
                  ],
                  "fold": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "filter": "(datum['degree'] !== 0)"
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "frame": [
                    null,
                    0
                  ],
                  "sort": [
                    {
                      "field": "set_order"
                    }
                  ],
                  "window": [
                    {
                      "as": "set_order",
                      "field": "set",
                      "op": "distinct"
                    }
                  ]
                },
                {
                  "frame": [
                    null,
                    null
                  ],
                  "window": [
                    {
                      "as": "intersection_id",
                      "field": "",
                      "op": "row_number"
                    }
                  ]
                },
                {
                  "from": {
                    "fields": [
                      "set_abbre"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "from": {
                    "fields": [
                      "set_order"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "groupby": [
                    "intersection_id",
                    "count"
                  ],
                  "op": "max",
                  "pivot": "set",
                  "value": "is_intersect"
                }
              ],
              "width": 900
            },
            {
              "encoding": {
                "color": {
                  "value": "#F7F7F7"
                },
                "tooltip": [
                  {
                    "aggregate": "max",
                    "field": "count",
                    "title": "Cardinality",
                    "type": "quantitative"
                  },
                  {
                    "field": "degree",
                    "title": "Degree",
                    "type": "quantitative"
                  }
                ],
                "x": {
                  "axis": {
                    "domain": false,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "intersection_id",
                  "sort": {
                    "field": "count",
                    "order": "ascending"
                  },
                  "title": null,
                  "type": "nominal"
                },
                "y": {
                  "axis": {
                    "domain": false,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "set_order",
                  "title": null,
                  "type": "nominal"
                }
              },
              "height": 280.0,
              "mark": "rect",
              "transform": [
                {
                  "aggregate": [
                    {
                      "as": "count",
                      "field": "count",
                      "op": "sum"
                    }
                  ],
                  "groupby": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "as": "degree",
                  "calculate": "(isDefined(datum['Alpha']) ? datum['Alpha'] : 0)+(isDefined(datum['Beta']) ? datum['Beta'] : 0)+(isDefined(datum['Gamma']) ? datum['Gamma'] : 0)+(isDefined(datum['Delta']) ? datum['Delta'] : 0)+(isDefined(datum['Eta']) ? datum['Eta'] : 0)+(isDefined(datum['Iota']) ? datum['Iota'] : 0)+(isDefined(datum['Kappa']) ? datum['Kappa'] : 0)+(isDefined(datum['Lambda']) ? datum['Lambda'] : 0)+(isDefined(datum['Mu']) ? datum['Mu'] : 0)+(isDefined(datum['Omicron']) ? datum['Omicron'] : 0)"
                },
                {
                  "as": [
                    "set",
                    "is_intersect"
                  ],
                  "fold": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "filter": "((datum['set_order'] % 2) === 1)"
                },
                {
                  "filter": "(datum['degree'] !== 0)"
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "frame": [
                    null,
                    0
                  ],
                  "sort": [
                    {
                      "field": "set_order"
                    }
                  ],
                  "window": [
                    {
                      "as": "set_order",
                      "field": "set",
                      "op": "distinct"
                    }
                  ]
                },
                {
                  "frame": [
                    null,
                    null
                  ],
                  "window": [
                    {
                      "as": "intersection_id",
                      "field": "",
                      "op": "row_number"
                    }
                  ]
                },
                {
                  "from": {
                    "fields": [
                      "set_abbre"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "from": {
                    "fields": [
                      "set_order"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "groupby": [
                    "intersection_id",
                    "count"
                  ],
                  "op": "max",
                  "pivot": "set",
                  "value": "is_intersect"
                }
              ],
              "width": 900
            }
          ]
        },
        {
          "layer": [
            {
              "encoding": {
                "color": {
                  "field": "set",
                  "scale": {
                    "domain": [
                      "Alpha",
                      "Beta",
                      "Gamma",
                      "Delta",
                      "Eta",
                      "Iota",
                      "Kappa",
                      "Lambda",
                      "Mu",
                      "Omicron"
                    ],
                    "range": [
                      "#5778a4",
                      "#e49444",
                      "#d1615d",
                      "#85b6b2",
                      "#6a9f58",
                      "#e7ca60",
                      "#a87c9f",
                      "#f1a2a9",
                      "#967662",
                      "#b8b0ac"
                    ]
                  },
                  "title": null,
                  "type": "nominal"
                },
                "opacity": {
                  "value": 1
                },
                "y": {
                  "axis": {
                    "domain": false,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "set_order",
                  "title": null,
                  "type": "nominal"
                }
              },
              "mark": {
                "size": 650,
                "type": "circle"
              },
              "selection": {
                "selector000": {
                  "bind": "legend",
                  "fields": [
                    "set"
                  ],
                  "type": "multi"
                }
              },
              "transform": [
                {
                  "aggregate": [
                    {
                      "as": "count",
                      "field": "count",
                      "op": "sum"
                    }
                  ],
                  "groupby": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "as": "degree",
                  "calculate": "(isDefined(datum['Alpha']) ? datum['Alpha'] : 0)+(isDefined(datum['Beta']) ? datum['Beta'] : 0)+(isDefined(datum['Gamma']) ? datum['Gamma'] : 0)+(isDefined(datum['Delta']) ? datum['Delta'] : 0)+(isDefined(datum['Eta']) ? datum['Eta'] : 0)+(isDefined(datum['Iota']) ? datum['Iota'] : 0)+(isDefined(datum['Kappa']) ? datum['Kappa'] : 0)+(isDefined(datum['Lambda']) ? datum['Lambda'] : 0)+(isDefined(datum['Mu']) ? datum['Mu'] : 0)+(isDefined(datum['Omicron']) ? datum['Omicron'] : 0)"
                },
                {
                  "as": [
                    "set",
                    "is_intersect"
                  ],
                  "fold": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "filter": "(datum['degree'] !== 0)"
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "frame": [
                    null,
                    0
                  ],
                  "sort": [
                    {
                      "field": "set_order"
                    }
                  ],
                  "window": [
                    {
                      "as": "set_order",
                      "field": "set",
                      "op": "distinct"
                    }
                  ]
                },
                {
                  "frame": [
                    null,
                    null
                  ],
                  "window": [
                    {
                      "as": "intersection_id",
                      "field": "",
                      "op": "row_number"
                    }
                  ]
                },
                {
                  "from": {
                    "fields": [
                      "set_abbre"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "from": {
                    "fields": [
                      "set_order"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "groupby": [
                    "intersection_id",
                    "count"
                  ],
                  "op": "max",
                  "pivot": "set",
                  "value": "is_intersect"
                }
              ]
            },
            {
              "encoding": {
                "color": {
                  "value": "white"
                },
                "opacity": {
                  "value": 1
                },
                "text": {
                  "field": "set_abbre",
                  "type": "nominal"
                },
                "y": {
                  "axis": {
                    "domain": false,
                    "grid": false,
                    "labels": false,
                    "ticks": false
                  },
                  "field": "set_order",
                  "title": null,
                  "type": "nominal"
                }
              },
              "mark": {
                "align": "center",
                "type": "text"
              },
              "transform": [
                {
                  "aggregate": [
                    {
                      "as": "count",
                      "field": "count",
                      "op": "sum"
                    }
                  ],
                  "groupby": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "as": "degree",
                  "calculate": "(isDefined(datum['Alpha']) ? datum['Alpha'] : 0)+(isDefined(datum['Beta']) ? datum['Beta'] : 0)+(isDefined(datum['Gamma']) ? datum['Gamma'] : 0)+(isDefined(datum['Delta']) ? datum['Delta'] : 0)+(isDefined(datum['Eta']) ? datum['Eta'] : 0)+(isDefined(datum['Iota']) ? datum['Iota'] : 0)+(isDefined(datum['Kappa']) ? datum['Kappa'] : 0)+(isDefined(datum['Lambda']) ? datum['Lambda'] : 0)+(isDefined(datum['Mu']) ? datum['Mu'] : 0)+(isDefined(datum['Omicron']) ? datum['Omicron'] : 0)"
                },
                {
                  "as": [
                    "set",
                    "is_intersect"
                  ],
                  "fold": [
                    "Alpha",
                    "Beta",
                    "Gamma",
                    "Delta",
                    "Eta",
                    "Iota",
                    "Kappa",
                    "Lambda",
                    "Mu",
                    "Omicron"
                  ]
                },
                {
                  "filter": "(datum['degree'] !== 0)"
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "filter": {
                    "selection": "selector000"
                  }
                },
                {
                  "frame": [
                    null,
                    0
                  ],
                  "sort": [
                    {
                      "field": "set_order"
                    }
                  ],
                  "window": [
                    {
                      "as": "set_order",
                      "field": "set",
                      "op": "distinct"
                    }
                  ]
                },
                {
                  "frame": [
                    null,
                    null
                  ],
                  "window": [
                    {
                      "as": "intersection_id",
                      "field": "",
                      "op": "row_number"
                    }
                  ]
                },
                {
                  "from": {
                    "fields": [
                      "set_abbre"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "from": {
                    "fields": [
                      "set_order"
                    ],
                    "key": "set"
                  },
                  "lookup": "set"
                },
                {
                  "groupby": [
                    "intersection_id",
                    "count"
                  ],
                  "op": "max",
                  "pivot": "set",
                  "value": "is_intersect"
                }
              ]
            }
          ]
        }
      ],
      "resolve": {
        "scale": {
          "y": "shared"
        }
      },
      "spacing": 5
    },
    {
      "layer": [
        {
          "encoding": {
            "color": {
              "condition": {
                "selection": {
                  "selector000": "selector002"
                },
                "value": "#3A3A3A"
              },
              "value": "#EA4667"
            },
            "text": {
              "field": "count",
              "format": ".0f",
              "type": "quantitative"
            },
            "tooltip": [
              {
                "aggregate": "max",
                "field": "count",
                "title": "Cardinality",
                "type": "quantitative"
              },
              {
                "field": "degree",
                "title": "Degree",
                "type": "quantitative"
              }
            ],
            "x": {
              "axis": {
                "domain": true,
                "grid": false,
                "labels": false,
                "ticks": false
              },
              "field": "intersection_id",
              "sort": {
                "field": "count",
                "order": "ascending"
              },
              "title": null,
              "type": "nominal"
            },
            "y": {
              "aggregate": "max",
              "axis": {
                "grid": false,
                "orient": "right",
                "tickCount": 3
              },
              "field": "count",
              "title": "Intersection Size",
              "type": "quantitative"
            }
          },
          "height": 420.0,
          "mark": {
            "color": "#3A3A3A",
            "dy": -10,
            "size": 16,
            "type": "text"
          },
          "transform": [
            {
              "aggregate": [
                {
                  "as": "count",
                  "field": "count",
                  "op": "sum"
                }
              ],
              "groupby": [
                "Alpha",
                "Beta",
                "Gamma",
                "Delta",
                "Eta",
                "Iota",
                "Kappa",
                "Lambda",
                "Mu",
                "Omicron"
              ]
            },
            {
              "as": "degree",
              "calculate": "(isDefined(datum['Alpha']) ? datum['Alpha'] : 0)+(isDefined(datum['Beta']) ? datum['Beta'] : 0)+(isDefined(datum['Gamma']) ? datum['Gamma'] : 0)+(isDefined(datum['Delta']) ? datum['Delta'] : 0)+(isDefined(datum['Eta']) ? datum['Eta'] : 0)+(isDefined(datum['Iota']) ? datum['Iota'] : 0)+(isDefined(datum['Kappa']) ? datum['Kappa'] : 0)+(isDefined(datum['Lambda']) ? datum['Lambda'] : 0)+(isDefined(datum['Mu']) ? datum['Mu'] : 0)+(isDefined(datum['Omicron']) ? datum['Omicron'] : 0)"
            },
            {
              "as": [
                "set",
                "is_intersect"
              ],
              "fold": [
                "Alpha",
                "Beta",
                "Gamma",
                "Delta",
                "Eta",
                "Iota",
                "Kappa",
                "Lambda",
                "Mu",
                "Omicron"
              ]
            },
            {
              "filter": "(datum['degree'] !== 0)"
            },
            {
              "filter": {
                "selection": "selector000"
              }
            },
            {
              "filter": {
                "selection": "selector000"
              }
            },
            {
              "frame": [
                null,
                0
              ],
              "sort": [
                {
                  "field": "set_order"
                }
              ],
              "window": [
                {
                  "as": "set_order",
                  "field": "set",
                  "op": "distinct"
                }
              ]
            },
            {
              "frame": [
                null,
                null
              ],
              "window": [
                {
                  "as": "intersection_id",
                  "field": "",
                  "op": "row_number"
                }
              ]
            },
            {
              "from": {
                "fields": [
                  "set_abbre"
                ],
                "key": "set"
              },
              "lookup": "set"
            },
            {
              "from": {
                "fields": [
                  "set_order"
                ],
                "key": "set"
              },
              "lookup": "set"
            },
            {
              "groupby": [
                "intersection_id",
                "count"
              ],
              "op": "max",
              "pivot": "set",
              "value": "is_intersect"
            }
          ],
          "width": 900
        },
        {
          "encoding": {
            "color": {
              "condition": {
                "selection": {
                  "selector000": "selector002"
                },
                "value": "#3A3A3A"
              },
              "value": "#EA4667"
            },
            "tooltip": [
              {
                "aggregate": "max",
                "field": "count",
                "title": "Cardinality",
                "type": "quantitative"
              },
              {
                "field": "degree",
                "title": "Degree",
                "type": "quantitative"
              }
            ],
            "x": {
              "axis": {
                "domain": true,
                "grid": false,
                "labels": false,
                "ticks": false
              },
              "field": "intersection_id",
              "sort": {
                "field": "count",
                "order": "ascending"
              },
              "title": null,
              "type": "nominal"
            },
            "y": {
              "aggregate": "max",
              "axis": {
                "grid": false,
                "orient": "right",
                "tickCount": 3
              },
              "field": "count",
              "title": "Intersection Size",
              "type": "quantitative"
            }
          },
          "height": 420.0,
          "mark": {
            "color": "#3A3A3A",
            "size": 30,
            "type": "bar"
          },
          "selection": {
            "selector000": {
              "bind": "legend",
              "fields": [
                "set"
              ],
              "type": "multi"
            },
            "selector001": {
              "fields": [
                "intersection_id"
              ],
              "on": "mouseover",
              "type": "single"
            }
          },
          "transform": [
            {
              "aggregate": [
                {
                  "as": "count",
                  "field": "count",
                  "op": "sum"
                }
              ],
              "groupby": [
                "Alpha",
                "Beta",
                "Gamma",
                "Delta",
                "Eta",
                "Iota",
                "Kappa",
                "Lambda",
                "Mu",
                "Omicron"
              ]
            },
            {
              "as": "degree",
              "calculate": "(isDefined(datum['Alpha']) ? datum['Alpha'] : 0)+(isDefined(datum['Beta']) ? datum['Beta'] : 0)+(isDefined(datum['Gamma']) ? datum['Gamma'] : 0)+(isDefined(datum['Delta']) ? datum['Delta'] : 0)+(isDefined(datum['Eta']) ? datum['Eta'] : 0)+(isDefined(datum['Iota']) ? datum['Iota'] : 0)+(isDefined(datum['Kappa']) ? datum['Kappa'] : 0)+(isDefined(datum['Lambda']) ? datum['Lambda'] : 0)+(isDefined(datum['Mu']) ? datum['Mu'] : 0)+(isDefined(datum['Omicron']) ? datum['Omicron'] : 0)"
            },
            {
              "as": [
                "set",
                "is_intersect"
              ],
              "fold": [
                "Alpha",
                "Beta",
                "Gamma",
                "Delta",
                "Eta",
                "Iota",
                "Kappa",
                "Lambda",
                "Mu",
                "Omicron"
              ]
            },
            {
              "filter": "(datum['degree'] !== 0)"
            },
            {
              "filter": {
                "selection": "selector000"
              }
            },
            {
              "filter": {
                "selection": "selector000"
              }
            },
            {
              "frame": [
                null,
                0
              ],
              "sort": [
                {
                  "field": "set_order"
                }
              ],
              "window": [
                {
                  "as": "set_order",
                  "field": "set",
                  "op": "distinct"
                }
              ]
            },
            {
              "frame": [
                null,
                null
              ],
              "window": [
                {
                  "as": "intersection_id",
                  "field": "",
                  "op": "row_number"
                }
              ]
            },
            {
              "from": {
                "fields": [
                  "set_abbre"
                ],
                "key": "set"
              },
              "lookup": "set"
            },
            {
              "from": {
                "fields": [
                  "set_order"
                ],
                "key": "set"
              },
              "lookup": "set"
            },
            {
              "groupby": [
                "intersection_id",
                "count"
              ],
              "op": "max",
              "pivot": "set",
              "value": "is_intersect"
            }
          ],
          "width": 900
        }
      ]
    }
  ]
}
