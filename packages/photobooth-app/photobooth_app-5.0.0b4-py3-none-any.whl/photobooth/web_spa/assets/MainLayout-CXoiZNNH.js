import{d as v,u as b,a as S,b as C,c as B,e as w,o as M,w as h,f as p,g as N,h as Q,i as A,j as E,k as T,r as $,l as d,m as l,n as c,p as m,Q as L,q as R,s as q,t as I,v as y}from"./index-x-yFzLoN.js";import{Q as O}from"./QPageSticky-CbWxV-GJ.js";import{Q as P,a as V}from"./QLayout-lP45nksm.js";const W=v({__name:"RouteAfterTimeout",props:{route:{type:String,required:!0},timeoutMs:{type:Number,required:!0},warningMessage:{type:String,default:"Auto-starting slideshow... Click anywhere to stay on this page."},warningTimeMs:{type:Number,default:1e4}},setup(g){const a=b(),n=S(),t=g,{idle:s,lastActive:i}=C(t.timeoutMs),o=B({interval:1e3}),e=w(()=>t.timeoutMs-(o.value-i.value)),_=w(()=>t.warningTimeMs>e.value);let r=null;function k(){r=a.notify({progress:!0,message:t.warningMessage,type:"info",multiLine:!0,timeout:e.value,icon:"sym_o_slideshow"})}function f(){r&&r()}return M(()=>{f()}),h(_,u=>{u?k():f()}),h(s,u=>{u&&(f(),n.push({path:t.route}))}),(u,x)=>(p(),N("div"))}}),U=v({__name:"MainLayout",setup(g){const a=Q(),n=A(),t=E(),s=S(),i=T();return a.$subscribe((o,e)=>{e.state=="counting"&&i.path!="/"&&(console.log("counting state received, pushing to index page to countdown"),s.push("/")),e.state=="present_capture"&&s.push({name:"itempresenter",params:{id:a.last_captured_mediaitem_id}}),e.state=="approve_capture"&&e.ask_user_for_approval&&s.push({path:"/itemapproval"})}),(o,e)=>{const _=$("router-view");return p(),d(V,{id:"main-layout",view:"hHh lpR fFf"},{default:l(()=>[c(P,null,{default:l(()=>[c(_),m(i).path!="/"?(p(),d(O,{key:0,position:"top-left",class:"q-ma-lg",style:{}},{default:l(()=>[c(L,{id:"layout-button-back",color:"primary",rounded:"","no-caps":"",onClick:e[0]||(e[0]=r=>o.$router.back()),class:"action-button"},{default:l(()=>[c(R,{left:"",name:"sym_o_arrow_back_ios_new"}),q("div",null,I(o.$t("BTN_LABEL_BACK")),1)]),_:1})]),_:1})):y("",!0),m(n).getConfigElement("uisettings.enable_automatic_slideshow",!1)&&m(t).collection_number_of_items>0?(p(),d(W,{key:1,route:"/slideshow/random","timeout-ms":m(n).getConfigElement("uisettings.show_automatic_slideshow_timeout",300)*1e3,"warning-message":o.$t("MSG_WARN_BEFORE_AUTO_SLIDESHOW")},null,8,["timeout-ms","warning-message"])):y("",!0)]),_:1})]),_:1})}}});export{U as default};
