import{x as G,y as D,z as H,A as F,d as P,B as $,e as c,C as O,o as W,D as B,E as I,f as n,g as u,s as p,n as l,m as g,F as X,t as N,G as J,H as U,p as d,I as y,l as h,q as L,v as o,J as M,Q as S,h as Y,i as Z,a as ee,K as te,L as ne,M as q}from"./index-x-yFzLoN.js";import{Q as E}from"./QPageSticky-CbWxV-GJ.js";import{Q as ie}from"./QPage-mkCqzv_8.js";import{Q as ae}from"./QCircularProgress-BRQgdaxi.js";import"./format-CJebrXOQ.js";const se='<circle cx="12.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="0s" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="52.5" r="12.5" fill-opacity=".5"><animate attributeName="fill-opacity" begin="100ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="300ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="600ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="800ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="400ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="700ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="500ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="200ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',oe=G({name:"QSpinnerGrid",props:D,setup(f){const{cSize:e,classes:t}=H(f);return()=>F("svg",{class:t.value,fill:"currentColor",width:e.value,height:e.value,viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg",innerHTML:se})}}),re='<g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle></g>',le=G({name:"QSpinnerPuff",props:D,setup(f){const{cSize:e,classes:t}=H(f);return()=>F("svg",{class:t.value,stroke:"currentColor",width:e.value,height:e.value,viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg",innerHTML:re})}}),ce={id:"countdown-timer-container",class:"flex flex-center",style:{width:"70vw",height:"70vh"}},ue=["innerHTML"],de={style:{height:"100%"}},me=P({__name:"CountdownTimer",props:{duration:{},messageDuration:{default:.5},messageText:{default:"ðŸ˜ƒ"}},setup(f){let e;const t=$(0),m=$(0),r=f,_=c(()=>t.value>0),a=c(()=>t.value>0),v=c(()=>t.value<=r.messageDuration);O(()=>{x()}),W(()=>{k()});const k=()=>{clearInterval(e),t.value=0},x=()=>{m.value=r.duration,t.value=m.value,console.log(`starting timer, duration=${m.value}`),e=window.setInterval(()=>{t.value-=.05,t.value<=0&&clearInterval(e)},50)};return(b,Q)=>B((n(),u("div",ce,[B(p("div",{id:"countdown-timer-message",style:{position:"absolute","font-size":"150px"},innerHTML:b.messageText},null,8,ue),[[I,v.value]]),p("div",de,[B(l(ae,{"show-value":!v.value,style:{width:"100%",height:"100%"},value:t.value,min:0,max:m.value,reverse:"","animation-speed":"100","font-size":"0.5em",size:"70vh",color:"primary",class:"text-secondary"},{default:g(()=>[X(N(parseFloat(t.value.toFixed(0))),1)]),_:1},8,["show-value","value","max"]),[[I,a.value]])])],512)),[[I,_.value]])}}),ge={class:"row q-gutter-md action-buttons"},pe={style:{"white-space":"nowrap"},class:"gt-sm"},fe=P({__name:"FrontpageTriggerButtons",props:{triggers:{}},emits:["triggerAction"],setup(f,{emit:e}){const t=e;function m(r,_){t("triggerAction",r,_)}return(r,_)=>(n(),u("div",ge,[(n(!0),u(J,null,U(r.triggers,(a,v)=>(n(),u("div",{key:v},[a.show_button&&!(d(y.isEmpty)(a.title)&&d(y.isEmpty)(a.icon))?(n(),h(S,{key:0,stack:"",color:"primary","no-caps":"",rounded:"",class:M(["action-button col-auto",["action-button-"+v]]),onClick:k=>m(a.action,a.config_index)},{default:g(()=>[d(y.isEmpty)(a.icon)?o("",!0):(n(),h(L,{key:0,name:`sym_o_${a.icon}`},null,8,["name"])),p("div",pe,N(a.title),1)]),_:2},1032,["class","onClick"])):o("",!0)]))),128))]))}}),ve={key:0,class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},_e={key:1,id:"frontpage-countdown",class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},he=["innerHTML"],ye={key:0},be={key:0},we={class:"q-gutter-md"},Ce={class:"gt-sm"},ke={key:0},xe={class:"q-gutter-md"},Te={class:"gt-sm"},Be=P({__name:"IndexPage",setup(f){const e=Y(),t=Z(),m=ee(),r=$(0);te(r,()=>{r.value>=5&&m.push("/admin"),r.value=0},{debounce:500});const _=c(()=>{const i=[];return["actions.image","actions.collage","actions.animation","actions.video","actions.multicamera","printer.print"].forEach(w=>{t.getConfigElement(w,[]).forEach((C,A)=>{const K={action:w.replace(".","/"),config_index:A,show_button:y.get(C,"trigger.ui_trigger.show_button",!1),title:y.get(C,"trigger.ui_trigger.title",""),icon:y.get(C,"trigger.ui_trigger.icon","")};i.push(K)})}),console.log(i),i}),a=c(()=>{const i=e.state=="capture";return e.state=="captures_completed"||i&&!b.value}),v=c(()=>e.state=="record"),k=c(()=>t.getConfigElement("uisettings.livestream_mirror_effect")),x=c(()=>t.getConfigElement("uisettings.admin_button_invisible",!1)),b=c(()=>{const i=e.state=="counting",s=e.state=="capture";return e.duration&&e.duration>0&&i||s}),Q=c(()=>{const i=t.getConfigElement("uisettings.enable_livestream_when_idle",!0),s=t.getConfigElement("uisettings.enable_livestream_when_active",!0),w=!e.state||e.state=="finished",z=e.state=="record",C=e.state=="counting",A=e.state=="capture";return w&&i||(C||A)&&s||z}),T=c(()=>!e.state||e.state=="finished"),R=()=>{x.value?r.value++:m.push("/admin")},V=(i,s)=>{q(`/api/${i}/${s}`)},j=()=>{q("/api/actions/stop")};return(i,s)=>(n(),h(ie,{id:"index-page",class:"q-pa-none column full-height"},{default:g(()=>[p("div",{id:"preview-stream-wrapper",class:M({mirroreffect:k.value})},[Q.value?(n(),u("div",{key:0,id:"preview-stream",style:{"background-image":"url('/api/aquisition/stream.mjpg')"},class:M(["full-width column justify-center content-center",{countdowncounting:b.value}])},null,2)):o("",!0)],2),a.value?(n(),u("div",ve,[l(oe,{size:"20em"})])):o("",!0),b.value?(n(),u("div",_e,[l(me,{ref:"countdowntimer",duration:d(e).duration,"message-duration":d(t).getConfigElement("uisettings.TAKEPIC_MSG_TIME"),"message-text":d(t).getConfigElement("uisettings.TAKEPIC_MSG_TEXT")},null,8,["duration","message-duration","message-text"])])):o("",!0),T.value?(n(),u("div",{key:2,id:"frontpage_text",innerHTML:d(t).getConfigElement("uisettings.FRONTPAGE_TEXT")},null,8,he)):o("",!0),l(E,{position:"bottom",class:"q-mb-lg"},{default:g(()=>[T.value?(n(),u("div",ye,[l(fe,{triggers:_.value,onTriggerAction:V},null,8,["triggers"])])):o("",!0)]),_:1}),l(E,{position:"top-left",class:"q-ma-lg"},{default:g(()=>[T.value?(n(),u("div",be,[p("div",we,[d(t).getConfigElement("uisettings.show_gallery_on_frontpage")?(n(),h(S,{key:0,id:"frontpage-button-to-gallery",color:"primary","no-caps":"",rounded:"",to:"/gallery",class:"action-button",style:ne(d(t).getConfigElement("uisettings.gallery_button_style"))},{default:g(()=>[l(L,{left:"",name:"sym_o_photo_library"}),p("div",Ce,N(i.$t("BTN_LABEL_MAINPAGE_TO_GALLERY")),1)]),_:1},8,["style"])):o("",!0)])])):o("",!0)]),_:1}),l(E,{position:"top-right",class:"q-ma-lg"},{default:g(()=>[T.value?(n(),u("div",ke,[p("div",xe,[d(t).getConfigElement("uisettings.show_admin_on_frontpage")?(n(),h(S,{key:0,id:"frontpage-button-to-admin",rounded:"",color:"transparent","no-caps":"",class:M(["action-button action-button-admin",{"action-button-admin-invisible":x.value}]),onClick:R},{default:g(()=>[l(L,{left:"",name:"sym_o_admin_panel_settings"}),p("div",Te,N(i.$t("BTN_LABEL_MAINPAGE_TO_ADMIN")),1)]),_:1},8,["class"])):o("",!0)])])):o("",!0)]),_:1}),v.value?(n(),h(E,{key:3,id:"frontpage-indicator-recording",position:"top",offset:[0,25],align:"center"},{default:g(()=>[l(le,{color:"red",size:"10em"}),s[1]||(s[1]=p("br",null,null,-1)),l(S,{flat:"",color:"red",label:"Stop recording",onClick:s[0]||(s[0]=w=>j())})]),_:1})):o("",!0)]),_:1}))}});export{Be as default};
