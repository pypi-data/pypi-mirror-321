{# templates/slurpit_nautobot/onboard_device.html #}
{% extends 'generic/object_list.html' %}
{% load buttons %}
{% load i18n %}
{% load helpers %}
{% load static %}
{% load perms %}

{% block title %}
  Onboard Devices
{% endblock %}

{% block header %}
  <div class="title-container px-3 pb-3">

    {# Title #}
    
    <div id="content-title">
      {% include "slurpit_nautobot/logo.html" %}
      {# Center-align title in object-edit views #}
      <h1 class="w-100" style="margin-top: 0px">Onboard Devices</h1>
      <style>
        h1:before {
          content: '';
        }
      </style>
      {% block subtitle %}{% endblock %}
    </div>

    {# Controls #}
    {% block controls %}{% endblock controls %}

  </div>
  <style>
    .greenLink a {
      color: #007dff !important
    }
  </style>

{% endblock header %}

{% block content %}
  <ul class="nav nav-tabs px-3">
        
    <li class="nav-item {% if request.GET.tab == 'new' or request.GET.tab is None %}active{% endif %}" role="presentation">
      <a class="nav-tab nav-link " href="?tab=new">
        New {% badge to_onboard_count %}
      </a>
    </li>
    <li class="nav-item {% if request.GET.tab == 'migrate' %}active{% endif %}" role="presentation">
      <a class="nav-tab nav-link" href="?tab=migrate">
        Migrate {% badge migrate_count %}
      </a>
    </li>
    <li class="nav-item {% if request.GET.tab == 'conflicted' %}active{% endif %}" role="presentation">
      <a class="nav-tab nav-link" href="?tab=conflicted">
        Conflict {% badge conflicted_count %}
      </a>
    </li>
    <li class="nav-item {% if request.GET.tab == 'onboarded' %}active{% endif %}" role="presentation">
      <a class="nav-tab nav-link" href="?tab=onboarded">
        Onboarded {% badge onboarded_count %}
      </a>
    </li>
    
  </ul>

  <div class="tab-content">
    {% if request.GET.tab == 'new' or request.GET.tab is None %}
      {% include "slurpit_nautobot/onboard/new_device_list.html" %}
    {% elif request.GET.tab == 'conflicted' %}
      {% include "slurpit_nautobot/onboard/conflict_device_list.html" %}
    {% elif request.GET.tab == 'migrate' %}
      {% include "slurpit_nautobot/onboard/migrate_device_list.html" %}
    {% elif request.GET.tab == 'onboarded' %}
      {% include "slurpit_nautobot/onboard/onboarded_device_list.html" %}
    {% endif %}
  </div> 
  <style>
    .footer {
      border-top-left-radius: 0px !important;
      border-top-right-radius: 0px !important;
      margin-left: 0px !important;
      margin-right: 0px !important;
    }
   
    .dropdown-menu .btn {
      background-color: transparent;
    }

  </style>
  <script>
    const projectButtons = document.querySelectorAll('.protect-btn');

    projectButtons.forEach(button => {
      button.addEventListener('click', protectButton);
    });
    function protectButton(event) {
        buttonName = event.target.textContent
        setTimeout(() => recoverButton(event, buttonName), 1500);
        event.target.classList.add('disabled');
        event.target.textContent = 'Please wait'
    }
    function recoverButton(event, buttonName) {
        event.target.classList.remove('disabled');
        event.target.textContent = buttonName
    }
  </script>

{% endblock content %}

<footer class="footer container-fluid">
  {% block footer %}
    <div class="row align-items-center justify-content-between mx-0">

      <div class="col-sm-12 col-md-auto fs-4 noprint">
        <nav class="nav justify-content-center justify-content-lg-start">
          {% block footer_links %}
            <a type="button" class="nav-link h6" href="https://slurpit.io" target="_blank">
              https://slurpit.io
            </a>
          {% endblock footer_links %}
        </nav>
      </div>

      <div class="col-sm-12 col-md-auto text-center text-lg-end text-muted"  >
        <span class="d-block d-md-inline">
          {% now 'T' %}
        </span>
        <span class="ms-md-3 d-block d-md-inline">{{ settings.HOSTNAME }} (v{{ settings.VERSION }})</span>
        <span class="ms-md-3 d-block d-md-inline">Slurpit(v{{ settings.PLUGINS_CONFIG.slurpit_nautobot.version }})</span>
      </div>

    </div>
    
  {% endblock footer %}
</footer>

