"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[355],{66799:(e,s,t)=>{t.d(s,{$N:()=>R,GM:()=>T,Gm:()=>_,H6:()=>z,Il:()=>L,Jv:()=>C,O8:()=>F,TY:()=>P,Yi:()=>A,Zp:()=>S,g0:()=>H,hF:()=>O,p8:()=>D,pO:()=>I,vK:()=>M,yP:()=>G});var l=t(95155),n=t(76441),a=t(32356),r=t(50951),c=t(9420),i=t(72568),o=t(12115);t(35431);var d=t(82957),u=t(24681),m=t(54607),h=t(33356),x=t(70707),p=t(29159),g=t.n(p),v=t(32727),j=t(93550),f=t(28224),b=t(88412),N=t(94860);let y=b.A,{useToken:w}=d.A,k=e=>{let{children:s,language:t,showCode:r=!0}=e,[c,i]=o.useState(r);return(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"flex",children:(0,l.jsxs)("div",{role:"button",onClick:()=>{i(!c)},className:"flex-1 mr-4",children:[!c&&(0,l.jsxs)("div",{className:"text-white hover:text-accent duration-300",children:[(0,l.jsx)(n.A,{className:"inline-block w-5 h-5"}),(0,l.jsx)("span",{className:"text-xs",children:" show"})]}),c&&(0,l.jsxs)("div",{className:"text-white hover:text-accent duration-300",children:[(0,l.jsx)(a.A,{className:"inline-block w-5 h-5"}),(0,l.jsx)("span",{className:"text-xs",children:" hide"})]})]})}),c&&(0,l.jsx)(y,{id:"codeDiv",className:"rounded-sm h-full break-all",children:String(s).replace(/\n$/,""),language:t,PreTag:"div",style:f.A})]})},A=e=>{let{children:s,onClick:t,className:n="p-3 px-5 "}=e;return(0,l.jsx)("button",{role:"button",className:" focus:ring ring-accent  ring-l-none  rounded  cursor-pointer hover:brightness-110 bg-accent transition duration-500    text-white ".concat(n," "),onClick:t,children:s})},S=e=>{let{children:s,title:t,subtitle:n,hoverable:a=!0,active:r,cursor:c="cursor-pointer",className:i="p-3",onClick:o}=e,d=r?"border-accent":"border-secondary hover:border-accent ";return d=a?d:"border-secondary",(0,l.jsx)("button",{tabIndex:0,onClick:o,role:"button",className:"".concat(d," border-2 bg-secondary  group ").concat(i," w-full text-left rounded ").concat(c," transition duration-300"),children:(0,l.jsxs)("div",{className:"mt- text-sm text-secondary  h-full break-words",children:[t&&(0,l.jsx)("div",{className:"text-accent rounded font-semibold  text-xs pb-1",children:t}),(0,l.jsx)("div",{children:n}),s]})})},C=e=>{let{title:s,subtitle:t,children:r,className:c=" p-3",open:i=!1}=e,[d,u]=o.useState(i),m="h-4 cursor-pointer inline-block mr-1";return(0,l.jsxs)("div",{onMouseDown:e=>{e.detail>1&&e.preventDefault()},className:"bordper border-secondary rounded",children:[(0,l.jsxs)("div",{onClick:()=>{u(!d)},className:"cursor-pointer bg-secondary p-2 rounded ".concat(d?"rounded-b-none ":" ",'"}'),children:[d&&(0,l.jsx)(a.A,{className:m}),!d&&(0,l.jsx)(n.A,{className:m}),(0,l.jsxs)("span",{className:" inline-block -mt-2 mb-2 text-xs",children:[" ",s]})]}),d&&(0,l.jsx)("div",{className:"".concat(c," bg-tertiary  rounded rounded-t-none"),children:r})]})},_=e=>{let{children:s}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"rounded bg-secondary  p-3",children:[(0,l.jsxs)("span",{className:"inline-block h-6 w-6 relative mr-2",children:[(0,l.jsx)(r.A,{className:"animate-ping text-accent absolute inline-flex h-full w-full rounded-ful  opacity-75"}),(0,l.jsx)(r.A,{className:"relative text-accent animate-spin  inline-flex rounded-full h-6 w-6"})]}),s]}),(0,l.jsx)("div",{className:"relative",children:(0,l.jsx)("div",{className:"loadbar rounded-b"})})]})},E=e=>{let{children:s,title:t,className:n="text-primary bg-primary "}=e;return(0,l.jsx)("div",{className:"rounded mt-4  border-secondary   ".concat(n),children:(0,l.jsxs)("div",{className:"mt-4 p-2 rounded border relative",children:[(0,l.jsx)("div",{className:"absolute  -top-3 inline-block ".concat(n),children:t}),(0,l.jsxs)("div",{className:"mt-2",children:[" ",s]})]})})},T=e=>{let{children:s,icon:t=null,className:n="",title:a="Detail View"}=e,[r,c]=o.useState(!1);return window.innerWidth,window.innerHeight,(0,l.jsxs)("div",{style:{minHeight:"100px"},className:"h-full    rounded mb-6  border-secondary ".concat(n),children:[(0,l.jsx)("div",{role:"button",onClick:()=>{c(!0)},className:"text-xs mb-2 h-full w-full break-words",children:t||s}),r&&(0,l.jsx)(u.A,{title:a,width:800,open:r,onCancel:()=>c(!1),footer:null,children:s})]})},H=e=>{let{className:s,title:t=""}=e;return(0,l.jsx)("div",{className:"animate-bounce ".concat(s),children:(0,l.jsx)("div",{className:"w-2 h-2 bg-accent rounded-full"})})},D=e=>{let{children:s,loading:t}=e;return(0,l.jsxs)(l.Fragment,{children:[t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-secondary flex  pointer-events-none",style:{opacity:.5}}),(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",style:{pointerEvents:"none"},children:(0,l.jsx)(H,{})})]}),(0,l.jsx)("div",{className:"relative",children:s})]})},I=e=>{let{data:s,className:t="",showCode:n=!0}=e,[a,r]=o.useState(!1);return(0,l.jsx)("div",{className:" w-full   chatbox prose dark:prose-invert text-primary rounded   ".concat(t),children:(0,l.jsx)(j.o,{className:"   w-full",remarkPlugins:[v.A],components:{code(e){let{node:s,inline:t,className:n,children:a,...r}=e,c=/language-(\w+)/.exec(n||""),i=c?c[1]:"text";return!t&&c?(0,l.jsx)(k,{...r,language:i,children:a}):(0,l.jsx)("code",{...r,className:n,children:a})}},children:function(e){return null==(e=null==e?void 0:e.replace(/\n/g,"  \n"))?void 0:e.replace(/```markdown\s+([\s\S]*?)\s+```/g,(e,s)=>s)}(s)})})},J=e=>{let{code:s,language:t="python",showLineNumbers:n=!1,className:a=" ",wrapLines:r=!1,maxHeight:i="400px",minHeight:d="auto"}=e,[u,m]=o.useState(!1);return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"  rounded absolute right-5 top-4 z-10 ",children:(0,l.jsxs)("div",{className:"relative border border-transparent w-full h-full",children:[(0,l.jsx)("div",{style:{zIndex:-1},className:"w-full absolute top-0 h-full bg-gray-900 hover:bg-opacity-0 duration-300 bg-opacity-50 rounded"}),(0,l.jsxs)("div",{className:"   ",children:[u&&(0,l.jsxs)("div",{className:"inline-block px-2 pl-3 text-white",children:[" ","\uD83C\uDF89 Copied!"," "]}),(0,l.jsx)(c.A,{role:"button",onClick:()=>{navigator.clipboard.writeText(s),m(!0),setTimeout(()=>{m(!1)},6e3)},className:"m-2  inline-block duration-300 text-white hover:text-accent w-5 h-5"})]})]})}),(0,l.jsx)("div",{id:"codeDivBox",className:"rounded w-full overflow-auto overflow-y-scroll   scroll ".concat(a),style:{maxHeight:i,minHeight:d},children:(0,l.jsx)(y,{id:"codeDiv",className:"rounded-sm h-full break-all",children:s,language:t,PreTag:"div",showLineNumbers:n,style:f.A,wrapLines:r,wrapLongLines:r})})]})},O=e=>{let{title:s,description:t,value:n,control:a,className:r,truncateLength:c=20}=e;return(0,l.jsxs)("div",{className:"".concat(r),children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{className:"text-primary inline-block",children:[s," "]}),(0,l.jsx)("span",{className:"text-xs ml-1 text-accent -mt-2 inline-block",children:(0,N.EJ)(n+"",c)})," ",(0,l.jsx)(m.A,{title:t,children:(0,l.jsx)(i.A,{className:"text-gray-400 inline-block w-4 h-4"})})]}),a,(0,l.jsx)("div",{className:"bordper-b  border-secondary border-dashed pb-2 mxp-2"})]})},R=e=>{let{src:s,className:t=""}=e,[n,a]=(0,o.useState)(!0);return(0,l.jsxs)("div",{className:"w-full rounded relative",children:[n&&(0,l.jsxs)("div",{className:"absolute h-24 inset-0 flex items-center justify-center",children:[(0,l.jsx)(H,{title:" loading .."})," "]}),(0,l.jsx)("img",{alt:"Dynamic content",src:s,className:"w-full  rounded ".concat(n?"opacity-0":"opacity-100"," ").concat(t),onLoad:()=>a(!1)})]})},L=e=>{let{csvUrl:s,className:t}=e,[n,a]=(0,o.useState)([]),[r,c]=(0,o.useState)([]),[i,d]=(0,o.useState)(!0),[u,m]=(0,o.useState)(50);(0,o.useEffect)(()=>{(async()=>{try{let e=await fetch(s),t=await e.text(),l=g().parse(t,{header:!0,dynamicTyping:!0,skipEmptyLines:!0});a(l.data);let n=l.data[0],r=Object.keys(n).map(e=>{let s={title:e.charAt(0).toUpperCase()+e.slice(1),dataIndex:e,key:e};return"number"==typeof n[e]?{...s,sorter:(s,t)=>s[e]-t[e]}:s});c(r),d(!1)}catch(e){console.error("Error fetching CSV data:",e),d(!1)}})()},[s]);let x=150*r.length;return(0,l.jsx)("div",{className:"CsvLoader ".concat(t),children:(0,l.jsx)(h.A,{dataSource:n,columns:r,loading:i,pagination:{pageSize:u},scroll:{y:450,x:x},onChange:e=>{m(e.pageSize||50)}})})},M=e=>{let{url:s,className:t}=e,[n,a]=(0,o.useState)(!0),[r,c]=(0,o.useState)(null);return o.useEffect(()=>{fetch(s).then(e=>e.text()).then(e=>{c(e),a(!1)})},[s]),(0,l.jsxs)("div",{className:"w-full rounded relative ".concat(t),children:[n&&(0,l.jsx)("div",{className:"absolute h-24 inset-0 flex items-center justify-center",children:(0,l.jsx)(H,{})}),!n&&(0,l.jsx)(J,{code:r||"",language:"python"})]})},z=e=>{let{url:s}=e,[t,n]=(0,o.useState)(!0);return o.useEffect(()=>{n(!1)},[s]),(0,l.jsxs)("div",{className:"h-full",children:[t&&(0,l.jsx)("p",{children:"Loading PDF..."}),!t&&(0,l.jsx)("object",{className:"w-full rounded",data:s,type:"application/pdf",width:"100%",height:"450px",children:(0,l.jsx)("p",{children:"PDF cannot be displayed."})})]})},P=e=>{let{value:s,editorRef:t,language:n,onChange:a,minimap:r=!0}=e,[c,i]=(0,o.useState)(!1);return(0,l.jsx)("div",{className:"h-full rounded",children:(0,l.jsx)(x.Ay,{height:"100%",className:"h-full rounded",defaultLanguage:n,defaultValue:s,value:s,onChange:e=>{a&&e&&a(e)},onMount:(e,s)=>{t.current=e,i(!0)},theme:"vs-dark",options:{wordWrap:"on",wrappingIndent:"indent",wrappingStrategy:"advanced",minimap:{enabled:r}}})})},F=e=>{let{items:s}=e,t=s.map((e,s)=>(0,l.jsx)("div",{role:"button",className:"text-accent text-xs inline-block hover:bg-primary p-2 rounded",onClick:e.onClick,children:(0,l.jsx)(m.A,{title:e.hoverText,children:(0,l.jsx)(e.icon,{className:" w-5, h-5 cursor-pointer inline-block"})})},"cardhoverrow"+s));return(0,l.jsx)("div",{onMouseEnter:e=>{e.stopPropagation()},className:" mt-2 text-right opacity-0 group-hover:opacity-100 ",children:t})},G=e=>{var s;let{message:t}=e;return(0,l.jsx)(E,{title:(0,l.jsxs)("div",{className:"rounded p-1 px-2 inline-block text-xs bg-secondary",children:[(0,l.jsx)("span",{className:"font-semibold",children:t.sender})," ( to"," ",t.recipient," )"]}),className:"m",children:(0,l.jsx)(I,{data:null===(s=t.message)||void 0===s?void 0:s.content,className:"text-sm"})})}},18593:(e,s,t)=>{t.d(s,{A:()=>A});var l=t(95155),n=t(38552),a=t(68144),r=t(72568),c=t(48338),i=t(18569),o=t(60915),d=t(79005),u=t(99373),m=t(7663),h=t(54607),x=t(12115),p=t(94860),g=t(71548),v=t(45142),j=t(38094),f=t(23462),b=t(66799),N=t(35431);let y=e=>{let{metadata:s}=e,t=(0,p.Tt)(),n=(e,s)=>{let n=e.extension,a=["image"].includes(e.type),r=["code"].includes(e.type),c=["csv"].includes(e.type),i=["pdf"].includes(e.type),o=["video"].includes(e.type),d=e.name||"unknown",u=e.path||"unknown",m=null,h=(0,l.jsxs)("div",{children:["image"===e.type?(0,l.jsx)(v.A,{className:"h-4 mr-1 inline-block"}):(0,l.jsx)(j.A,{className:"h-4 mr-1 inline-block"})," ",(0,l.jsx)("span",{className:"break-all ",children:d})," "]}),x=(0,l.jsx)("div",{className:"p-2 bg-secondary rounded flex items-center justify-center   h-full",children:(0,l.jsxs)("div",{className:"",children:[(0,l.jsx)("div",{style:{fontSize:"2em"},className:"  text-center mb-2",children:e.extension}),(0,l.jsx)("div",{children:h})]})});return a?x=m=(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"mb-2",children:h}),(0,l.jsx)(b.$N,{src:"".concat(t,"/").concat(u),className:"w-full rounded"})]}):o?(m=(0,l.jsxs)("div",{className:"mb-2",children:[(0,l.jsx)("a",{href:"".concat(t,"/").concat(u),children:h}),(0,l.jsxs)("video",{controls:!0,className:"w-full rounded",children:[(0,l.jsx)("source",{src:"".concat(t,"/").concat(u),type:"video/".concat(n)}),"Your browser does not support the video tag."]})]}),x=(0,l.jsxs)("div",{className:"   relative rounded   h-full",children:[(0,l.jsx)("div",{className:"absolute rounded p-2 bg-secondary top-0 ",children:h}),(0,l.jsx)("div",{style:{minHeight:"150px"},className:"bg-secondary h-full w-full rounded  flex items-center justify-center text-primary ",children:(0,l.jsx)(f.A,{className:"h-14 w-14"})})]})):c?(m=(0,l.jsxs)("div",{className:"h",children:[(0,l.jsx)("a",{href:"".concat(t,"/").concat(u),children:(0,l.jsx)("div",{className:"mb-4",children:h})}),(0,l.jsx)(b.Il,{csvUrl:"".concat(t,"/").concat(u),className:"w-full rounded"})]}),x=(0,l.jsxs)("div",{className:"   relative rounded   h-full",children:[(0,l.jsx)("div",{className:"absolute rounded p-2 bg-secondary top-0 ",children:h}),(0,l.jsx)("div",{style:{minHeight:"150px"},className:"bg-secondary  h-full w-full rounded  flex items-center justify-center text-primary",children:(0,l.jsx)(N.A,{icon:"csv",size:14})})]})):r?(m=(0,l.jsxs)("div",{className:"h",children:[(0,l.jsx)("a",{href:"".concat(t,"/").concat(u),target:"_blank",rel:"noopener noreferrer",children:(0,l.jsx)("div",{className:"mb-4",children:h})}),(0,l.jsx)(b.vK,{url:"".concat(t,"/").concat(u),className:"w-full rounded"})]}),x=(0,l.jsxs)("div",{className:"   relative rounded   h-full",children:[(0,l.jsx)("div",{className:"absolute rounded p-2 bg-secondary top-0 ",children:h}),(0,l.jsx)("div",{style:{minHeight:"150px"},className:"bg-secondary  h-full w-full rounded  flex items-center justify-center text-primary",children:(0,l.jsx)(N.A,{icon:"python",size:14})})]})):i?(m=(0,l.jsxs)("div",{className:"h-full",children:[(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)("a",{href:"".concat(t,"/").concat(u),target:"_blank",rel:"noopener noreferrer",children:h})}),(0,l.jsx)(b.H6,{url:"".concat(t,"/").concat(u)})]}),x=(0,l.jsxs)("div",{className:"   relative rounded   h-full",children:[(0,l.jsx)("div",{className:"absolute rounded p-2 bg-secondary top-0 ",children:h}),(0,l.jsx)("div",{style:{minHeight:"150px"},className:"bg-secondary h-full w-full rounded  flex items-center justify-center text-primary ",children:(0,l.jsx)(N.A,{icon:"pdf",size:14})})]})):m=(0,l.jsx)("span",{children:"Unsupported file type."}),(0,l.jsx)("div",{className:"  h-full rounded",children:(0,l.jsx)(b.GM,{className:"mb-1",icon:x,title:d,children:m})})},a=(s.files||[]).map((e,s)=>(0,l.jsx)("div",{className:"text-primary ",children:n(e,s)},"metafilesrow"+s)),r=(s.messages||[]).map((e,s)=>(0,l.jsx)("div",{className:" mb-2 border-dashed",children:(0,l.jsx)(b.yP,{message:e})},"messagerow"+s)),c=a.length>0,i=r.length>0;return(0,l.jsxs)("div",{children:[i&&(0,l.jsx)("div",{className:"rounded   bg-primary  ",children:(0,l.jsx)(b.Jv,{open:!1,title:"Agent Messages (".concat(r.length," message").concat(r.length>1?"s":"",") | ").concat((0,p.a3)(null==s?void 0:s.time)),children:r})}),c&&(0,l.jsx)("div",{className:"rounded mt-2",children:(0,l.jsx)(b.Jv,{open:!0,title:"Results (".concat(a.length," file").concat(a.length>1?"s":"",")"),children:(0,l.jsx)("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:a})})})]})};var w=t(49058);let k=[],A=e=>{let{initMessages:s,session:t,editable:v=!0,heightOffset:j=160}=e,f=x.useRef(null),N=x.useRef(null),{user:A}=x.useContext(g.v),S=x.useRef(null),C=x.useRef([]),[_,E]=x.useState("disconnected"),[T,H]=x.useState(null),[D,I]=x.useState([]),[J,O]=x.useState(0),R=(0,p.Tt)(),L=R.replace("http","ws")+"/ws/";if(R.includes("http"))L=R.replace("http","ws")+"/ws/";else{let e=new URL(window.location.href);L=(e.protocol+"//"+e.host+R).replace("http","ws")+"/ws/"}let[M,z]=x.useState(!1),[P,F]=x.useState(""),[G,U]=x.useState({status:!0,message:"All good"}),Y=x.useRef(null),K=(0,w.J)(e=>e.connectionId),W=(0,w.J)(e=>e.messages),B=(0,w.J)(e=>e.setMessages),V=e=>{let s;try{s=JSON.parse(e.meta)}catch(t){s=e.meta}return{text:e.content,sender:"user"===e.role?"user":"bot",meta:s,msg_id:e.msg_id}},$=e=>null==e?void 0:e.map(V);x.useEffect(()=>{let e=$(s);B(e),C.current=e,k=[]},[s]);let q=p.Mj.map((e,s)=>(0,l.jsxs)(d.Ay,{type:"primary",className:"",onClick:()=>{ea(e.prompt)},children:[" ",e.title," "]},"prompt"+s)),Z=null==W?void 0:W.map((e,s)=>{let t="user"===e.sender,r=t?"bg-accent text-white  ":"bg-light";if(e.meta){var c,i,o;null!==e.meta.code||(null===(c=e.meta.images)||void 0===c?void 0:c.length)>0||(null===(i=e.meta.files)||void 0===i?void 0:i.length)>0||null===(o=e.meta.scripts)||void 0===o||o.length}let d=[];t&&(d.push({label:(0,l.jsxs)("div",{onClick:()=>{console.log("retrying"),ea(e.text)},children:[(0,l.jsx)(n.A,{role:"button",title:"Retry",className:"h-4 w-4 mr-1 inline-block"}),"Retry"]}),key:"retrymessage"}),d.push({label:(0,l.jsxs)("div",{onClick:()=>{navigator.clipboard.writeText(e.text),u.Ay.success("Message copied to clipboard")},children:[(0,l.jsx)(a.A,{role:"button",title:"Copy",className:"h-4 w-4 mr-1 inline-block"}),"Copy"]}),key:"copymessage"}));let h=(0,l.jsx)(m.A,{menu:{items:d},trigger:["click"],placement:"bottomRight",children:(0,l.jsx)("div",{role:"button",className:"float-right ml-2 duration-100 hover:bg-secondary font-semibold px-2 pb-1  rounded",children:(0,l.jsx)("span",{className:"block -mt-2 text-primary  ",children:" ..."})})});return(0,l.jsxs)("div",{className:"align-right ".concat(t?"text-righpt":"","  mb-2 border-b"),children:[" ",(0,l.jsxs)("div",{className:"  ".concat(t?"":" w-full"," inline-flex gap-2"),children:[(0,l.jsx)("div",{className:""}),(0,l.jsx)("div",{className:"font-semibold text-secondary text-sm w-16",children:"".concat(t?"USER":"AGENTS")}),(0,l.jsxs)("div",{className:"inline-block group relative w-full p-2 rounded  ".concat(r),children:[" ",d.length>0&&v&&(0,l.jsx)("div",{className:" group-hover:opacity-100 opacity-0 ",children:h}),t&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"inline-block",children:e.text})}),!t&&(0,l.jsx)("div",{className:" w-full chatbox prose dark:prose-invert text-primary rounded ",children:(0,l.jsx)(b.pO,{className:"text-sm",data:e.text,showCode:!1})}),e.meta&&(0,l.jsx)("div",{className:"",children:(0,l.jsx)(y,{metadata:e.meta})})]})]})]},"message"+s)});x.useEffect(()=>{setTimeout(()=>{es(N)},500)},[W]);let Q="50px";x.useEffect(()=>{!1===M&&f.current&&f.current&&(null===G||G&&!1===G.status)&&(f.current.value="",f.current.style.height=Q)},[M]),x.useEffect(()=>{if(f.current){f.current.style.height=Q;let e=f.current.scrollHeight;f.current.style.height="".concat(e,"px")}},[P]);let[X,ee]=x.useState(null);x.useEffect(()=>{if(X)return;let e=L+K;if(console.log("socketUrl",e),!S.current){let s=new WebSocket(e);return S.current=s,s.onerror=e=>{console.log("ws error",e)},s.onopen=()=>{E("connected"),console.log("ws opened")},s.onclose=()=>{S.current&&(console.log("ws closed by server"),X||(E("disconnected"),ee(!0),E("reconnecting"),setTimeout(()=>{ee(null)},2e3)))},s.onmessage=e=>{let s=JSON.parse(e.data);if(console.log("received message",s),s&&"agent_message"===s.type){let e=Object.assign([],D);e.push(s.data),I(e),k.push(s.data),setTimeout(()=>{es(Y),es(N)},200)}else if(s&&"agent_status"===s.type){let e=document.getElementById("agentstatusspan");e&&(e.innerHTML=s.data.message)}else s&&"agent_response"===s.type&&el(s.data)},()=>{console.log("Cleanup"),S.current=null,s.close()}}},[X]);let es=e=>{var s;null===(s=e.current)||void 0===s||s.scroll({top:e.current.scrollHeight,behavior:"smooth"})},et=x.useRef(null),el=e=>{if(e&&e.status){let s=V(e.data);C.current.push(s),B(C.current),z(!1)}else console.log("error",e),u.Ay.error(e.message),z(!1)},en=e=>{let s="".concat(R,"/workflows/").concat(e,"?user_id=").concat(null==A?void 0:A.email);(0,p.hI)(s,{method:"GET",headers:{"Content-Type":"application/json"}},e=>{e&&e.status?e.data&&e.data.length>0&&H(e.data[0]):u.Ay.error(e.message)},e=>{U(e),u.Ay.error(e.message)})},ea=e=>{U(null),k=[];let s=Object.assign([],W),l={text:e,sender:"user",msg_id:(0,p.Os)()};s.push(l),B(s),C.current.push(l);let n={role:"user",content:e,user_id:(null==A?void 0:A.email)||"",session_id:null==t?void 0:t.id,workflow_id:null==t?void 0:t.workflow_id,connection_id:K},a="".concat(R,"/sessions/").concat(null==t?void 0:t.id,"/workflow/").concat(null==t?void 0:t.workflow_id,"/run"),r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)};z(!0),S.current&&1===S.current.readyState?S.current.send(JSON.stringify({connection_id:K,data:n,type:"user_message",session_id:null==t?void 0:t.id,workflow_id:null==t?void 0:t.workflow_id})):fetch(a,r).then(e=>{200===e.status?e.json().then(e=>{el(e)}):(e.json().then(e=>{console.log("error",e),u.Ay.error(e.message),z(!1)}),u.Ay.error("Connection error. Ensure server is up and running."))}).catch(()=>{z(!1),u.Ay.error("Connection error. Ensure server is up and running.")}).finally(()=>{setTimeout(()=>{es(N)},500)})};return x.useEffect(()=>{t&&t.workflow_id&&en(t.workflow_id)},[t]),(0,l.jsxs)("div",{style:{height:"calc(100vh - "+j+"px)"},className:"text-primary    relative   rounded  ",ref:et,children:[(0,l.jsxs)("div",{style:{zIndex:100},className:" absolute right-3 bg-primary   rounded  text-secondary -top-6  p-2",children:[" ",T&&(0,l.jsxs)("div",{className:"text-xs",children:[" ",T.name]})]}),(0,l.jsxs)("div",{ref:N,className:"flex h-full  flex-col rounded  scroll pr-2 overflow-auto  ",style:{minHeight:"30px",height:"calc(100vh - 310px)"},children:[(0,l.jsxs)("div",{className:"scroll-gradient h-10",children:[" ",(0,l.jsx)("span",{className:"  inline-block h-6"})," "]}),(0,l.jsx)("div",{className:"flex-1  boder mt-4"}),!W&&null!==W&&(0,l.jsxs)("div",{className:"w-full text-center boder mt-4",children:[(0,l.jsxs)("div",{children:[" ",(0,l.jsx)(b.g0,{})]}),"loading messages"]}),W&&(null==W?void 0:W.length)===0&&(0,l.jsxs)("div",{className:"ml-2 text-sm text-secondary ",children:[(0,l.jsx)(r.A,{className:"inline-block h-6 mr-2"}),"No messages in the current session. Start a conversation to begin."]}),(0,l.jsxs)("div",{className:"ml-2",children:[" ",Z]}),M&&(0,l.jsxs)("div",{className:" inline-flex gap-2 duration-300 ",children:[(0,l.jsx)("div",{className:""}),(0,l.jsx)("div",{className:"font-semibold text-secondary text-sm w-16",children:"AGENTS"}),(0,l.jsxs)("div",{className:"relative w-full  ",children:[(0,l.jsx)("div",{className:"mb-2  ",children:(0,l.jsx)(b.Gm,{children:(0,l.jsxs)("div",{className:"mb-1  inline-block ml-2 text-xs text-secondary",children:[(0,l.jsxs)("span",{className:"innline-block text-sm ml-2",children:[" ",(0,l.jsxs)("span",{id:"agentstatusspan",children:[" ","agents working on task .."]})]})," ",k.length>0&&(0,l.jsxs)("span",{className:"border-l inline-block text-right ml-2 pl-2",children:[k.length," agent message",k.length>1&&"s"," sent/received."]})]})})}),k.length>0&&(0,l.jsx)("div",{ref:Y,style:{minHeight:"300px",maxHeight:"400px",overflowY:"auto"},className:"inline-block scroll group relative   p-2 rounded w-full bg-light ",children:(0,l.jsx)(b.Jv,{open:!0,title:"Agent Messages (".concat(k.length," message").concat(k.length>1?"s":"",") "),children:null==k?void 0:k.map((e,s)=>(0,l.jsx)("div",{children:(0,l.jsx)(b.yP,{message:e})},s))})})]})]})]}),v&&(0,l.jsxs)("div",{className:"mt-2 p-2 absolute   bg-primary  bottom-0 w-full",children:[(0,l.jsx)("div",{className:"rounded p-2 shadow-lg flex mb-1  gap-2 ".concat(M?" opacity-50 pointer-events-none":""),children:(0,l.jsxs)("form",{autoComplete:"on",className:"flex-1 relative",onSubmit:e=>{e.preventDefault()},children:[(0,l.jsx)("textarea",{id:"queryInput",name:"queryInput",autoComplete:"on",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||!f.current||M||(e.preventDefault(),ea(f.current.value))},onChange:e=>{F(e.target.value)},placeholder:"Write message here...",ref:f,className:"flex items-center w-full resize-none text-gray-600 bg-white p-2 ring-2 rounded-sm pl-5 pr-16",style:{maxHeight:"120px",overflowY:"auto",minHeight:"50px"}}),(0,l.jsxs)("div",{role:"button",style:{width:"45px",height:"35px"},title:"Send message",onClick:()=>{f.current&&!M&&ea(f.current.value)},className:"absolute right-3 bottom-2 bg-accent hover:brightness-75 transition duration-300 rounded cursor-pointer flex justify-center items-center",children:[" ",!M&&(0,l.jsxs)("div",{className:"inline-block  ",children:[(0,l.jsx)(c.A,{className:"h-6 w-6 text-white "})," "]}),M&&(0,l.jsx)("div",{className:"inline-block   ",children:(0,l.jsx)(i.A,{className:"text-white animate-spin rounded-full h-6 w-6"})})]})]})})," ",(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mt-2 text-xs text-secondary",children:[(0,l.jsxs)(h.A,{title:"Socket ".concat(_),children:[(0,l.jsx)("div",{className:"w-1 h-3 rounded  inline-block mr-1 ".concat((e=>"connected"===e?"bg-green-500":"reconnecting"===e?"bg-orange-500":"disconnected"===e?"bg-red-500":void 0)(_))})," "]}),"Blank slate? Try one of the example prompts below"," "]}),(0,l.jsx)("div",{className:"mt-2 inline-flex gap-2 flex-wrap  ".concat(M?"brightness-75 pointer-events-none":""),children:q})]}),G&&!G.status&&(0,l.jsxs)("div",{className:"p-2   rounded mt-4 text-orange-500 text-sm",children:[" ",(0,l.jsx)(o.A,{className:"h-5 text-orange-500 inline-block mr-2"})," ",G.message]})]})]})}}}]);