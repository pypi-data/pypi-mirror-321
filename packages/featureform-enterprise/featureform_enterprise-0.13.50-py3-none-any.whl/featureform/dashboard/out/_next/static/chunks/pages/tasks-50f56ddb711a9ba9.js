(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3689],{1849:function(a,b,c){"use strict";var d=c(64836);b.Z=void 0;var e=d(c(64938)),f=c(85893),g=(0,e.default)((0,f.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");b.Z=g},42761:function(a,b,c){"use strict";var d=c(64836);b.Z=void 0;var e=d(c(64938)),f=c(85893),g=(0,e.default)((0,f.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");b.Z=g},56670:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tasks",function(){return c(40947)}])},40947:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return _}});var d=c(85893),e=c(67294),f=c(47568),g=c(14924),h=c(26042),i=c(69396),j=c(34051),k=c.n(j),l=c(1849),m=c(42761),n=c(99226),o=c(83321),p=c(15861),q=c(87918),r=c(94054),s=c(33841),t=c(31085),u=c(18972),v=c(61903),w=c(87109),x=c(93946),y=c(34386),z=c(98456),A=c(13264),B=c(11163),C=c(310),D=c(35133),E=c(82670),F=c(29815),G=c(14564),H=c(57850);function I(a){var b,c,e=a.status;return(0,d.jsx)(q.Z,{sx:{backgroundColor:null!==(b=({3:"#D1FAD0",2:"#FAECD0",1:"#FAECD0",4:"#FAD0F6",5:"#D6D0FA"})[e])&& void 0!==b?b:D.Cj},size:"small",label:null!==(c=({0:"No Status",1:"Created",2:"Pending",3:"Ready",4:"Failed",5:"Running"})[e])&& void 0!==c?c:"No Status"})}var J=c(50594),K=c(86886),L=c(23795),M=c(20999),N=c(81143),O="#B3B5DC",P="TaskRunCard",Q={taskCardBox:"".concat(P,"-taskCardBox"),inputRow:"".concat(P,"-inputRow"),activeButton:"".concat(P,"-activeButton"),activeChip:"".concat(P,"-activeChip"),inactiveChip:"".concat(P,"-inactiveChip"),inactiveButton:"".concat(P,"-inactiveButton"),buttonText:"".concat(P,"-buttonText"),filterInput:"".concat(P,"-filterInput"),search:"".concat(P,"-search")},R=(0,A.Z)("div")(function(){var a;return a={},(0,g.Z)(a,"& .".concat(Q.taskCardBox),{height:750,width:700}),(0,g.Z)(a,"& .".concat(Q.inputRow),{paddingBottom:10,"& button":{height:40}}),(0,g.Z)(a,"& .".concat(Q.activeButton),{color:"#000000",fontWeight:"bold"}),(0,g.Z)(a,"& .".concat(Q.activeChip),{color:D.Cj,background:"#7A14E5",height:20,width:25,fontSize:11}),(0,g.Z)(a,"& .".concat(Q.inactiveChip),{color:D.Cj,background:"#BFBFBF",height:20,width:25,fontSize:11}),(0,g.Z)(a,"& .".concat(Q.inactiveButton),{color:"#000000",background:D.Cj}),(0,g.Z)(a,"& .".concat(Q.buttonText),{textTransform:"none",paddingRight:10}),(0,g.Z)(a,"& .".concat(Q.filterInput),{minWidth:225,height:40}),(0,g.Z)(a,"& .".concat(Q.search),{background:"#101205",width:350,"& label":{color:O},"& label.Mui-focused":{color:O},"& .MuiOutlinedInput-root":{color:O,borderColor:O,"& fieldset":{borderColor:O},"&.Mui-focused fieldset":{borderColor:O}}}),a});function S(a){var b,c,g,h,i,j=a.handleClose,m=a.taskId,o=a.taskRunId,q=(0,C.E)(),r=(0,B.useRouter)(),s=(0,e.useState)({}),t=s[0],u=s[1],w=(0,e.useState)(!0),A=w[0],D=w[1],E=[{field:"runId",headerName:"runId",width:1,editable:!1,sortable:!1,filterable:!1,hide:!0,hideable:!1,display:!1},{field:"startTime",headerName:"Start Time",sortable:!1,filterable:!1,width:200,valueGetter:function(a){var b,c;return(c=new Date(null==a?void 0:null===(b=a.row)|| void 0===b?void 0:b.startTime)).toLocaleString()}},{field:"status",headerName:"Status",width:200,align:"right",editable:!1,sortable:!1,filterable:!1,renderCell:function(a){var b;return(0,d.jsx)(I,{status:null==a?void 0:null===(b=a.row)|| void 0===b?void 0:b.status})}},{field:"link",headerName:"Link",width:250,editable:!1,sortable:!1,filterable:!1,valueGetter:function(){return""}},],F=function(){var a,b,c,d,e,f,g=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{},h=null==g?void 0:null===(a=g.taskRun)|| void 0===a?void 0:null===(b=a.target)|| void 0===b?void 0:b.name,i=null==g?void 0:null===(c=g.taskRun)|| void 0===c?void 0:null===(d=c.target)|| void 0===d?void 0:d.variant,j=M.Z[N.nf[null==g?void 0:null===(e=g.taskRun)|| void 0===e?void 0:null===(f=e.target)|| void 0===f?void 0:f.type]];if(h&&i&&j){var k="".concat(j.urlPath,"/").concat(h,"?variant=").concat(i);r.push(k)}else console.warn("handleResourceClick() could not create resource link. name(".concat(h,") variant(").concat(i,") resourceType(").concat(null==j?void 0:j.urlPath,")"))};(0,e.useEffect)(function(){var a,b=null;return(a=(0,f.Z)(k().mark(function a(){var c;return k().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(m&&o&&A)){a.next=6;break}return a.next=3,q.getTaskRunDetails(m,o);case 3:u(c=a.sent),b=setTimeout(function(){D(!1)},750);case 6:case"end":return a.stop()}},a)})),function(){return a.apply(this,arguments)})(),function(){b&&clearTimeout(b)}},[m,o,A,q]);var G=function(){A||D(!0)};return(0,d.jsx)(R,{children:(0,d.jsxs)(n.Z,{className:Q.taskCardBox,children:[(0,d.jsxs)(n.Z,{style:{float:"right"},children:[(0,d.jsx)(y.Z,{title:"Refresh card",placement:"bottom",children:(0,d.jsx)(x.Z,{variant:"",size:"large",onClick:G,children:A?(0,d.jsx)(z.Z,{size:".75em"}):(0,d.jsx)(l.Z,{"data-testid":"taskRunRefreshIcon"})})}),(0,d.jsx)(x.Z,{variant:"",size:"large",onClick:function(){return j()},children:(0,d.jsx)(J.Z,{})})]}),(0,d.jsxs)(K.ZP,{style:{padding:10},container:!0,children:[(0,d.jsx)(K.ZP,{item:!0,xs:7,justifyContent:"flex-start",children:(0,d.jsx)(p.Z,{variant:"h5",children:(0,d.jsx)(L.Z,{style:{cursor:"pointer"},onClick:function(){return F(t)},children:null!==(g=null==t?void 0:null===(b=t.taskRun)|| void 0===b?void 0:b.name)&& void 0!==g?g:""})})}),(0,d.jsx)(K.ZP,{item:!0,xs:4,justifyContent:"center",children:(0,d.jsxs)(p.Z,{variant:"h6",children:[(0,d.jsx)("strong",{children:"Status:"})," ",(0,d.jsx)(I,{status:null!==(h=null==t?void 0:null===(c=t.taskRun)|| void 0===c?void 0:c.status)&& void 0!==h?h:""})]})}),(0,d.jsx)(K.ZP,{item:!0,xs:12,justifyContent:"flex-start",style:{paddingTop:20},children:(0,d.jsx)(p.Z,{variant:"h6",children:"Logs/Errors"})}),(0,d.jsx)(K.ZP,{item:!0,xs:12,justifyContent:"flex-start",children:(0,d.jsx)(v.Z,{style:{width:"100%"},variant:"filled",disabled:!0,value:function(){var a,b,c=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{},d="";return(null==c?void 0:null===(a=c.taskRun)|| void 0===a?void 0:a.logs)&&(d+=c.taskRun.logs.join("\n")),(null==c?void 0:null===(b=c.taskRun)|| void 0===b?void 0:b.error)&&(d+="\n"+c.taskRun.error),d}(t),multiline:!0,minRows:3})}),(0,d.jsx)(K.ZP,{item:!0,xs:12,justifyContent:"flex-start",style:{paddingTop:20},children:(0,d.jsx)(p.Z,{variant:"h6",children:"Other Runs"})}),(0,d.jsx)(K.ZP,{item:!0,xs:12,justifyContent:"flex-start"}),(0,d.jsx)(K.ZP,{item:!0,xs:12,justifyContent:"center",children:(0,d.jsx)(H._,{density:"compact",autoHeight:!0,"aria-label":"Other Runs",sx:{"& .MuiDataGrid-cell:focus":{outline:"none"},"& .MuiDataGrid-columnHeaderTitle":{fontWeight:"bold"}},rows:null!==(i=null==t?void 0:t.otherRuns)&& void 0!==i?i:[],disableColumnMenu:!0,rowsPerPageOptions:[5],columns:E,initialState:{pagination:{paginationModel:{page:0,pageSize:5}}},pageSize:5,getRowId:function(a){return a.runId}})})]})]})})}function T(a){var b=a.taskRunList,c=a.setPage,f=void 0===c?function(){return null}:c,g=a.count,h=a.currentPage,i=function(){l(!1)},j=(0,e.useState)(!1),k=j[0],l=j[1],m=(0,e.useState)({taskRun:{taskId:0,runId:0}}),n=m[0],o=m[1],p={0:"Resource Creation",1:"Health Check",2:"Metrics"},q=function(a){return(0,E.Z)(a,Date)&&!isNaN(a)},r=(0,F.Z)(void 0===b?[]:b).sort(function(a,b){var c,d,e=new Date(null===(c=a.taskRun)|| void 0===c?void 0:c.startTime),f=new Date(null===(d=b.taskRun)|| void 0===d?void 0:d.startTime);return q(e)&&q(f)?f.getTime()-e.getTime():(console.warn("A task start time prop is invalid:",null==a?void 0:a.taskRun,null==b?void 0:b.taskRun),0)}),s=function(a){var b=null==r?void 0:r.find(function(b){return b.taskRun.taskId===a.row.taskRun.taskId&&b.taskRun.runId===a.row.taskRun.runId});o(null!=b?b:{taskRun:{taskId:0,runId:0}}),l(function(b){return n!==a.row.id||!b})},t=[{field:"id",headerName:"Id",flex:1,width:100,editable:!1,sortable:!1,filterable:!1,hide:!0},{field:"taskId",headerName:"Task Id",flex:0,width:75,editable:!1,sortable:!1,filterable:!1,hide:!1,valueGetter:function(a){var b,c;return null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.taskRun)|| void 0===c?void 0:c.taskId}},{field:"runId",headerName:"Run Id",flex:0,width:75,editable:!1,sortable:!1,filterable:!1,hide:!1,valueGetter:function(a){var b,c;return null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.taskRun)|| void 0===c?void 0:c.runId}},{field:"name",headerName:"Task Name",flex:1,minWidth:250,editable:!1,sortable:!1,filterable:!1,valueGetter:function(a){var b,c;return null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.taskRun)|| void 0===c?void 0:c.name},hide:!0},{field:"resource",headerName:"Resource",flex:1,minWidth:150,editable:!1,sortable:!1,filterable:!1,valueGetter:function(a){var b,c,d;return null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.task)|| void 0===c?void 0:null===(d=c.target)|| void 0===d?void 0:d.name}},{field:"variant",headerName:"Variant",flex:1,minWidth:175,editable:!1,sortable:!1,filterable:!1,valueGetter:function(a){var b,c,d;return null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.task)|| void 0===c?void 0:null===(d=c.target)|| void 0===d?void 0:d.variant}},{field:"jobType",headerName:"Task Type",flex:1,minWidth:150,editable:!1,sortable:!1,filterable:!1,valueGetter:function(a){var b,c,d;return null!==(d=p[null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.task)|| void 0===c?void 0:c.type])&& void 0!==d?d:""}},{field:"status",headerName:"Status",flex:0,minWidth:75,editable:!1,sortable:!1,filterable:!1,valueGetter:function(a){var b,c;return null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.taskRun)|| void 0===c?void 0:c.status},renderCell:function(a){var b,c;return(0,d.jsx)(I,{status:null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.taskRun)|| void 0===c?void 0:c.status})}},{field:"startTime",headerName:"Start Time",flex:1,sortable:!1,filterable:!1,minWidth:175,valueGetter:function(a){var b,c,d;return(d=new Date(null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.taskRun)|| void 0===c?void 0:c.startTime)).toLocaleString()}},{field:"endTime",headerName:"End Time",flex:1,sortable:!1,filterable:!1,minWidth:175,valueGetter:function(a){var b,c,d,e=(d=new Date(null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.taskRun)|| void 0===c?void 0:c.endTime)).toLocaleString();return e.startsWith("12/31/1")?"---":e}},{field:"triggeredBy",headerName:"Triggered By",flex:1,width:125,editable:!1,valueGetter:function(a){var b,c,d;return null==a?void 0:null===(b=a.row)|| void 0===b?void 0:null===(c=b.taskRun)|| void 0===c?void 0:null===(d=c.trigger)|| void 0===d?void 0:d.triggerName},hide:!0},],u=U(null==r?void 0:r.length);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(G.ZP,{open:k,anchorReference:"anchorPosition",anchorPosition:{top:250,left:Number.MAX_SAFE_INTEGER},onClose:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,d.jsx)(S,{handleClose:i,taskId:n.taskRun.taskId,taskRunId:n.taskRun.runId})}),(0,d.jsx)(H._,{autoHeight:!0,sx:{minWidth:300,"& .MuiDataGrid-cell:focus":{outline:"none"},"& .MuiDataGrid-row:hover":{cursor:"pointer"},"& .MuiDataGrid-columnHeaderTitle":{fontWeight:"bold"}},onRowClick:s,rowsPerPageOptions:[15],disableColumnMenu:!0,density:"compact","aria-label":"Task Runs",rows:null!=r?r:[],columns:t,hideFooterSelectedRowCount:!0,rowCount:void 0===g?0:g,page:void 0===h?0:h,paginationMode:"server",onPageChange:function(a){f(a)},pageSize:u,getRowId:function(a){return a.id}})]})}function U(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:0,b=5;return a>=10?15:a>=5?10:5}var V="TableDataWrapper",W={inputRow:"".concat(V,"-inputRow"),activeButton:"".concat(V,"-activeButton"),activeChip:"".concat(V,"-activeChip"),inactiveChip:"".concat(V,"-inactiveChip"),inactiveButton:"".concat(V,"-inactiveButton"),buttonText:"".concat(V,"-buttonText"),filterInput:"".concat(V,"-filterInput"),taskCardBox:"".concat(V,"-taskCardBox")},X=(0,A.Z)("div")(function(){var a;return a={},(0,g.Z)(a,"& .".concat(W.inputRow),{paddingBottom:10,"& button":{height:40}}),(0,g.Z)(a,"& .".concat(W.activeButton),{color:"#000000",fontWeight:"bold"}),(0,g.Z)(a,"& .".concat(W.activeChip),{color:D.Cj,background:"#7A14E5",height:20,width:25,fontSize:11}),(0,g.Z)(a,"& .".concat(W.inactiveChip),{color:D.Cj,background:"#BFBFBF",height:20,width:25,fontSize:11}),(0,g.Z)(a,"& .".concat(W.inactiveButton),{color:"#000000",background:D.Cj}),(0,g.Z)(a,"& .".concat(W.buttonText),{textTransform:"none",paddingRight:10}),(0,g.Z)(a,"& .".concat(W.filterInput),{minWidth:225,height:40}),(0,g.Z)(a,"& .".concat(W.taskCardBox),{height:750,width:700}),a});function Y(){var a=(0,B.useRouter)().query.name,b=(0,C.E)(),c="ACTIVE",g="COMPLETE",j="DATE",A=Object.freeze({status:"ALL",sortBy:j,searchText:"",pageSize:15,offset:0}),D=null!=a?a:"",E=(0,e.useState)((0,i.Z)((0,h.Z)({},A),{searchText:D})),F=E[0],G=E[1],H=(0,e.useState)(D),I=H[0],J=H[1],K=(0,e.useState)(0),L=K[0],M=K[1],N=(0,e.useState)([]),O=N[0],P=N[1],Q=(0,e.useState)(!0),R=Q[0],S=Q[1],U=(0,e.useState)(),V=U[0],Y=(0,e.useState)(),Z=Y[0],$=(0,e.useState)(),_=$[0];(0,e.useEffect)(function(){var a;(a=(0,f.Z)(k().mark(function a(){var c,d,e,f;return k().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!R){a.next=10;break}return a.next=3,b.getTaskRuns(F);case 3:return P(null!==(d=null==(c=a.sent)?void 0:c.list)&& void 0!==d?d:[]),M(null!==(e=null==c?void 0:c.count)&& void 0!==e?e:0),f=setTimeout(function(){S(!1)},750),a.abrupt("return",function(){f&&clearTimeout(f)});case 10:case"end":return a.stop()}},a)})),function(){return a.apply(this,arguments)})()},[F,R]);var aa=function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:"ALL";G((0,i.Z)((0,h.Z)({},F),{status:a})),S(!0)},ab=function(a){var b,c,d=null!==(c=null==a?void 0:null===(b=a.target)|| void 0===b?void 0:b.value)&& void 0!==c?c:"";G((0,i.Z)((0,h.Z)({},F),{sortBy:d})),S(!0)},ac=function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:"";G((0,i.Z)((0,h.Z)({},F),{searchText:a})),S(!0)},ad=function(){R||S(!0)},ae=function(a){G((0,i.Z)((0,h.Z)({},F),{offset:a})),S(!0)},af=function(){G((0,h.Z)({},A)),J(""),S(!0)};return(0,d.jsxs)(X,{children:[(0,d.jsxs)(n.Z,{className:W.inputRow,children:[(0,d.jsxs)(o.Z,{variant:"text",className:"ALL"===F.status?W.activeButton:W.inactiveButton,onClick:function(){return aa("ALL")},children:[(0,d.jsx)(p.Z,{variant:"button",className:W.buttonText,children:"All"}),(0,d.jsx)(q.Z,{label:V,"data-testid":"allId",className:"ALL"===F.status?W.activeChip:W.inactiveChip})]}),(0,d.jsxs)(o.Z,{variant:"text",className:F.status===c?W.activeButton:W.inactiveButton,onClick:function(){return aa(c)},children:[(0,d.jsx)(p.Z,{variant:"button",className:W.buttonText,children:"Active"}),(0,d.jsx)(q.Z,{label:Z,"data-testid":"activeId",className:F.status===c?W.activeChip:W.inactiveChip})]}),(0,d.jsxs)(o.Z,{variant:"text",className:F.status===g?W.activeButton:W.inactiveButton,onClick:function(){return aa(g)},children:[(0,d.jsx)(p.Z,{variant:"button",className:W.buttonText,children:"Complete"}),(0,d.jsx)(q.Z,{label:_,"data-testid":"completeId",className:F.status===g?W.activeChip:W.inactiveChip})]}),(0,d.jsxs)(n.Z,{style:{float:"right"},children:[(0,d.jsxs)(r.Z,{style:{paddingRight:"15px"},children:[(0,d.jsx)(s.Z,{shrink:!0,id:"sortId",children:"Sort By"}),(0,d.jsxs)(t.Z,{value:F.sortBy,onChange:ab,label:"Sort By",notched:!0,className:W.filterInput,children:[(0,d.jsx)(u.Z,{value:"STATUS",children:"Status"}),(0,d.jsx)(u.Z,{value:j,children:"Date"}),(0,d.jsx)(u.Z,{value:"RUN_ID",children:"RunId"})]})]}),(0,d.jsx)(r.Z,{children:(0,d.jsx)(v.Z,{size:"small",InputLabelProps:{shrink:!0},label:"Search",onChange:function(a){var b,c=a.target.value;if(""===c){J(c),ac("");return}var d=null!==(b=a.target.value)&& void 0!==b?b:"";d.trim()&&J(d)},value:I,onKeyDown:function(a){"Enter"===a.key&&I&&ac(I)},InputProps:{endAdornment:(0,d.jsx)(w.Z,{position:"end",children:(0,d.jsx)(x.Z,{children:(0,d.jsx)(m.Z,{})})})},inputProps:{"aria-label":"search","data-testid":"searcInputId"}})}),(0,d.jsx)(y.Z,{title:"Refresh table",placement:"top",children:(0,d.jsx)(x.Z,{size:"large",onClick:ad,children:R?(0,d.jsx)(z.Z,{size:".85em","data-testid":"circularProgressId"}):(0,d.jsx)(l.Z,{"data-testid":"refreshIcon"})})}),(0,d.jsx)(y.Z,{title:"Clear filter inputs",placement:"top",children:(0,d.jsx)(x.Z,{size:"large",onClick:af,children:(0,d.jsx)("img",{alt:"CLEAR","data-testid":"clearIcon",src:"/static/clearIcon.svg"})})})]})]}),(0,d.jsx)(T,{count:L,currentPage:F.offset,setPage:ae,taskRunList:null==O?void 0:O.map(function(a){return(0,i.Z)((0,h.Z)({},a),{id:a.taskRun.taskId+"."+a.taskRun.runId})})})]})}var Z=(0,A.Z)("div")(function(){return{padding:20}});function $(){return(0,d.jsxs)(Z,{children:[(0,d.jsx)("h3",{children:"Task Runs"}),(0,d.jsx)(Y,{})]})}var _=function(){return(0,d.jsx)($,{})}}},function(a){a.O(0,[9774,2888,179],function(){var b;return a(a.s=56670)}),_N_E=a.O()}])
//# sourceMappingURL=tasks-50f56ddb711a9ba9.js.map