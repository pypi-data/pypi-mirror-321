import{m as v,_,c as y,r as u,I as w,S as b,t as I}from"./index-C_iAD1KJ.js";import{v as S}from"./FormGroup-DFdr3vqD-B29mjSrf.js";const x={setup(){const t=u(!1),e=u(!1),a=w(),o=b(),r=u();async function s(n,i,d){try{return a.settings.extraTokenParams={second_factor:d},await a.signinResourceOwnerCredentials({username:n,password:i})}finally{a.settings.extraTokenParams={}}}let l="",p="";async function m(n,i,d){t.value=!0,r.value=void 0;try{await s(n,i,d),o()}catch(c){if(c instanceof I&&c.error==="invalid_request"){if(c.error_description==='Missing or invalid "second_factor" in request.')if(e.value){r.value="INVALID_CREDENTIALS";return}else{e.value=!0,l=n,p=i;return}r.value="INVALID_CREDENTIALS";return}console.error(c),r.value="OTHER_ERROR"}finally{t.value=!1}}function f(n,i){return m(n,i)}function g(n){return m(l,p,n)}return{login:f,provideSecondFactor:g,secondFactorRequired:e,isLoading:t,error:r}}};var C=function(){var t=this,e=t._self._c;return e("div",[t.secondFactorRequired?t._t("second-factor",null,{provideSecondFactor:t.provideSecondFactor,isLoading:t.isLoading,error:t.error}):t._t("default",null,{login:t.login,isLoading:t.isLoading,error:t.error})],2)},h=[],E=v(x,C,h,!1,null,null);const F=E.exports,L={components:{FormGroup:S,Oauth2ClientCredentialsGrantPageWrapper:F},setup(){const{i18n:t}=_(),e=y(()=>{const s=t.t("sign in to start your session");return s.slice(0,1).toUpperCase()+s.slice(1)}),a=u(""),o=u(""),r=u("");return{username:a,password:o,secondFactor:r,signInTo:e}}};var $=function(){var t=this,e=t._self._c;return e("Oauth2ClientCredentialsGrantPageWrapper",{scopedSlots:t._u([{key:"default",fn:function({login:a,error:o}){return[e("form",{on:{submit:function(r){return r.preventDefault(),(()=>a(t.username,t.password)).apply(null,arguments)}}},[e("p",{staticStyle:{"text-align":"center"}},[t._v(" "+t._s(t.signInTo)+" "+t._s(t.$t("or"))+" "),e("router-link",{attrs:{to:{name:"registration"}}},[t._v(t._s(t.$t("sign up")))]),t._v(". ")],1),e("div",{staticClass:"form-group has-feedback"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-control",attrs:{id:"username",autocomplete:"username",autofocus:"",maxlength:"254",name:"username",placeholder:t.$t("Username").toString(),required:"",type:"text"},domProps:{value:t.username},on:{input:function(r){r.target.composing||(t.username=r.target.value)}}})]),e("div",{staticClass:"form-group has-feedback"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{id:"password",autocomplete:"current-password",name:"password",placeholder:t.$t("Password").toString(),type:"password",required:""},domProps:{value:t.password},on:{input:function(r){r.target.composing||(t.password=r.target.value)}}})]),o?e("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[t._v(" "+t._s(o==="INVALID_CREDENTIALS"?t.$t("Invalid username or password"):t.$t("Error! Try again later"))+" ")]):t._e(),e("button",{staticClass:"btn btn-primary btn-block",staticStyle:{"margin-bottom":"5px","text-transform":"capitalize"},attrs:{type:"submit"}},[t._v(" "+t._s(t.$t("sign in"))+" ")]),e("router-link",{staticStyle:{"text-transform":"capitalize"},attrs:{to:{name:"password-reset"}}},[t._v(" "+t._s(t.$t("forgot password"))+"? ")])],1)]}},{key:"second-factor",fn:function({provideSecondFactor:a,error:o}){return[e("form",{on:{submit:function(r){return r.preventDefault(),(()=>a(t.secondFactor)).apply(null,arguments)}}},[e("FormGroup",{attrs:{label:"Authentication code"},scopedSlots:t._u([{key:"default",fn:function({id:r,classes:s}){return[e("input",{directives:[{name:"model",rawName:"v-model",value:t.secondFactor,expression:"secondFactor"}],class:s,attrs:{id:r,type:"text",inputmode:"numeric"},domProps:{value:t.secondFactor},on:{input:function(l){l.target.composing||(t.secondFactor=l.target.value)}}})]}}],null,!0)}),e("p",[t._v(" "+t._s(t.$t("Enter the code from the two-factor app on your mobile device. If you've lost your device, you may enter one of your recovery codes."))+" ")]),o?e("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[t._v(" "+t._s(o==="INVALID_CREDENTIALS"?"Invalid code":"Error! Try again later")+" ")]):t._e(),e("button",{staticClass:"btn btn-primary btn-block",staticStyle:{"margin-bottom":"5px","text-transform":"capitalize"},attrs:{type:"submit"}},[t._v(" "+t._s(t.$t("sign in"))+" ")])],1)]}}])})},k=[],R=v(L,$,k,!1,null,null);const D=R.exports;export{D as default};
