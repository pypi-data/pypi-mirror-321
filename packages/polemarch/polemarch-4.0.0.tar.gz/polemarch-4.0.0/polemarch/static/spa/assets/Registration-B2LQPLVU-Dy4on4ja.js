import{m as y,d as _,u as g,_ as b,$ as k,r as n,b as h,v as x}from"./index-C_iAD1KJ.js";import{v as P}from"./FormGroup-DFdr3vqD-B29mjSrf.js";import{k as S}from"./BackButton-BoogC8Ev-CR44bVC7.js";const E=_({__name:"Registration",setup(r){const t=g(),{i18n:e}=b(),a=k(),s=n(),o=n(),p=n(""),m=n(""),u=n({}),l=n([]),f=n(!1);h(()=>{x(()=>{var i;(i=o.value)==null||i.setCustomValidity(p.value!==m.value?e.t("Passwords do not match."):"")})});async function w(){const i=s.value;if(i)try{const v=new URL("oauth2/registration/",a.api.url);v.search=new URLSearchParams({lang:e.locale}).toString();const d=await fetch(v,{method:"POST",body:JSON.stringify(Object.fromEntries(new FormData(i).entries())),headers:{"Content-Type":"application/json"}}),c=await d.json();u.value={},l.value=[],d.ok?c.email_confirmation_required?f.value=!0:t.push({name:"login"}):d.status===400?(u.value=c,c.detail&&(l.value=[c.detail])):l.value=["An error occurred. Please try again later."]}catch{u.value={},l.value=["An error occurred. Please try again later."]}}return{__sfc:!0,router:t,i18n:e,config:a,formEl:s,password2El:o,password1:p,password2:m,errors:u,nonFieldsErrors:l,emailConfirmationRequired:f,register:w,FormGroup:P,BackButton:S}}});var F=function(){var r=this,t=r._self._c,e=r._self._setupProxy;return e.emailConfirmationRequired?t("div",{staticStyle:{gap:"10px",display:"flex","flex-direction":"column"}},[r._v(" "+r._s(r.$t("You have successfully registered. Please check your email for a confirmation link."))+" "),t("router-link",{staticClass:"btn btn-primary btn-block",staticStyle:{"text-transform":"capitalize"},attrs:{to:{name:"login"}}},[r._v(r._s(r.$t("login")))])],1):t("form",{ref:"formEl",on:{submit:function(a){return a.preventDefault(),e.register.apply(null,arguments)}}},[t(e.FormGroup,{attrs:{label:"Username",errors:e.errors.username},scopedSlots:r._u([{key:"default",fn:function({classes:a,id:s}){return[t("input",{class:a,attrs:{id:s,autocomplete:"username",autofocus:"",name:"username",required:"",type:"text"}})]}}])}),t(e.FormGroup,{attrs:{label:"Email",errors:e.errors.email},scopedSlots:r._u([{key:"default",fn:function({classes:a,id:s}){return[t("input",{class:a,attrs:{id:s,autocomplete:"email",name:"email",required:"",type:"text"}})]}}])}),t(e.FormGroup,{attrs:{label:"Password",errors:e.errors.password},scopedSlots:r._u([{key:"default",fn:function({classes:a,id:s}){return[t("input",{directives:[{name:"model",rawName:"v-model",value:e.password1,expression:"password1"}],class:a,attrs:{id:s,autocomplete:"new-password",name:"password",required:"",type:"password"},domProps:{value:e.password1},on:{input:function(o){o.target.composing||(e.password1=o.target.value)}}})]}}])}),t(e.FormGroup,{attrs:{label:"Repeat password",errors:e.errors.password2},scopedSlots:r._u([{key:"default",fn:function({classes:a,id:s}){return[t("input",{directives:[{name:"model",rawName:"v-model",value:e.password2,expression:"password2"}],ref:"password2El",class:a,attrs:{id:s,autocomplete:"new-password",name:"password2",type:"password",required:""},domProps:{value:e.password2},on:{input:function(o){o.target.composing||(e.password2=o.target.value)}}})]}}])}),r._l(e.nonFieldsErrors,function(a,s){return t("div",{key:s,staticClass:"alert alert-danger",attrs:{role:"alert"}},[r._v(" "+r._s(r.$t(a))+" ")])}),t("button",{staticClass:"btn btn-primary btn-block",staticStyle:{"text-transform":"capitalize"}},[r._v(" "+r._s(r.$t("register"))+" ")]),t(e.BackButton)],2)},$=[],C=y(E,F,$,!1,null,null);const B=C.exports;export{B as default};
