import{m as v,d as y,u as _,x as g,$,_ as b,r as n,b as h,v as P}from"./index-C_iAD1KJ.js";import{v as C}from"./FormGroup-DFdr3vqD-B29mjSrf.js";const k=y({__name:"PasswordResetConfirm",setup(s){const r=_(),e=g(),o=$(),{i18n:t}=b(),a=n(!1),d=n(""),m=n(""),p=n(),c=n(""),w=n([]);h(()=>{P(()=>{var l,i;d.value!==m.value?(l=p.value)==null||l.setCustomValidity(`${t.t("Passwords do not match.")}`):(i=p.value)==null||i.setCustomValidity("")})});async function f(){a.value=!0;try{const l=new URL("oauth2/password_reset_confirm/",o.api.url);l.search=new URLSearchParams({lang:t.locale}).toString();const i=await fetch(l,{method:"POST",body:JSON.stringify({uid:e.params.uid,token:e.params.token,password:d.value}),headers:{"Content-Type":"application/json"}});if(!i.ok){const u=await i.json();if(u.password)w.value=u.password;else if(u.uid||u.token)c.value="Invalid link. Please request a new one.";else throw new Error("Invalid response");return}r.push({name:"login",replace:!0})}catch{c.value="An error occurred. Please try again later."}finally{a.value=!1}}return{__sfc:!0,router:r,route:e,config:o,i18n:t,isLoading:a,password:d,password2:m,password2El:p,error:c,passwordErrors:w,submit:f,FormGroup:C}}});var E=function(){var s=this,r=s._self._c,e=s._self._setupProxy;return r("form",{on:{submit:function(o){return o.preventDefault(),e.submit.apply(null,arguments)}}},[r("p",[s._v(" "+s._s(s.$t("Please enter your new password twice so we can verify you typed it in correctly."))+" ")]),r(e.FormGroup,{attrs:{label:`${s.$t("New password")}`,errors:e.passwordErrors},scopedSlots:s._u([{key:"default",fn:function({classes:o,id:t}){return[r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],class:o,attrs:{id:t,type:"password",name:"password"},domProps:{value:e.password},on:{input:function(a){a.target.composing||(e.password=a.target.value)}}})]}}])}),r(e.FormGroup,{attrs:{label:`${s.$t("Confirm password")}`},scopedSlots:s._u([{key:"default",fn:function({classes:o,id:t}){return[r("input",{directives:[{name:"model",rawName:"v-model",value:e.password2,expression:"password2"}],ref:"password2El",class:o,attrs:{id:t,type:"password",name:"password2"},domProps:{value:e.password2},on:{input:function(a){a.target.composing||(e.password2=a.target.value)}}})]}}])}),e.error?r("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[s._v(" "+s._s(s.$t(e.error))+" ")]):s._e(),r("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.isLoading}},[s._v(" "+s._s(s.$t("Change my Password"))+" ")])],1)},S=[],x=v(k,E,S,!1,null,null);const R=x.exports;export{R as default};
