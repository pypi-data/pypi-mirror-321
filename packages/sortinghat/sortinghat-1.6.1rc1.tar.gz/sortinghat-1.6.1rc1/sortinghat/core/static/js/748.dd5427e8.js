"use strict";(self["webpackChunksortinghat_ui"]=self["webpackChunksortinghat_ui"]||[]).push([[748],{41748:(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var n=a(20641),l=a(90033),s=a(53751),u=a(13892),i=a(40276),r=a(418),c=a(95272),o=a(22162),f=a(32421),d=a(1560),m=a(56756),k=a(35526),b=a(79669),p=a(19336),v=a(20552),h=a(49930),y=a(36554),_=a(80594),F=a(43948),x=function(e){return(0,n.Qi)("data-v-694a9ab3"),e=e(),(0,n.jt)(),e},V={class:"section"},A=x((function(){return(0,n.Lk)("header",{class:"header"},[(0,n.Lk)("h1",{class:"title"},"General settings")],-1)})),g=x((function(){return(0,n.Lk)("p",{class:"subheader mb-0"}," Affiliate to organizations automatically ",-1)})),w={key:0,class:"v-list-item__subtitle text-medium-emphasis"},E=x((function(){return(0,n.Lk)("label",{class:"d-sr-only"}," Affiliate to organizations ",-1)})),L=x((function(){return(0,n.Lk)("p",{class:"text-subtitle-2"},"Advanced configuration",-1)})),T=x((function(){return(0,n.Lk)("h3",{class:"subheader"},"Interval",-1)})),S=x((function(){return(0,n.Lk)("p",{class:"subheader mb-0"},"Unify profiles automatically",-1)})),U={key:0,class:"mt-3"},W={class:"v-list-item__subtitle text-medium-emphasis"},C=x((function(){return(0,n.Lk)("label",{class:"d-sr-only"},"Unify profiles automatically",-1)})),$=x((function(){return(0,n.Lk)("p",{class:"text-subtitle-2"},"Advanced configuration",-1)})),j=x((function(){return(0,n.Lk)("h3",{class:"subheader text-medium-emphasis"}," Unify profiles based on their ",-1)})),B=x((function(){return(0,n.Lk)("h3",{class:"subheader"},"Interval",-1)}));function I(e,t,a,x,I,X){return(0,n.uX)(),(0,n.CE)("section",V,[A,I.isLoading?((0,n.uX)(),(0,n.Wv)(p.Z,{key:0,color:"primary",indeterminate:""})):((0,n.uX)(),(0,n.Wv)(r.$t,{key:1,variant:"accordion"},{default:(0,n.k6)((function(){return[(0,n.bF)(c.c,null,{default:(0,n.k6)((function(){return[(0,n.bF)(o.w,{"aria-label":"Show advanced configuration"},{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 px-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"d-flex flex-column justify-center"},{default:(0,n.k6)((function(){return[g,I.tasks.affiliate.lastExecution?((0,n.uX)(),(0,n.CE)("span",w,[I.tasks.affiliate.failed?((0,n.uX)(),(0,n.Wv)(b.w,{key:0,color:"error",left:"",small:""},{default:(0,n.k6)((function(){return[(0,n.eW)(" mdi-alert ")]})),_:1})):((0,n.uX)(),(0,n.Wv)(b.w,{key:1,color:"green",left:"",small:""},{default:(0,n.k6)((function(){return[(0,n.eW)(" mdi-check ")]})),_:1})),(0,n.eW)(" Last run "+(0,l.v_)(e.$formatDate(I.tasks.affiliate.lastExecution)),1)])):(0,n.Q3)("",!0)]})),_:1}),(0,n.bF)(k.B,{class:"d-flex justify-end"},{default:(0,n.k6)((function(){return[(0,n.bF)(_.N,{modelValue:I.tasks.affiliate.isActive,"onUpdate:modelValue":t[0]||(t[0]=function(e){return I.tasks.affiliate.isActive=e}),class:"mt-0",color:"primary",density:"comfortable",inset:"","hide-details":"",onChange:t[1]||(t[1]=function(e){return X.toggleTask("affiliate")}),onClick:t[2]||(t[2]=(0,s.D$)((function(){}),["stop"])),onMousedown:t[3]||(t[3]=(0,s.D$)((function(){}),["prevent"]))},{label:(0,n.k6)((function(){return[E]})),_:1},8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.bF)(f.T,null,{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 pt-4 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"pa-0"},{default:(0,n.k6)((function(){return[L]})),_:1})]})),_:1}),(0,n.bF)(d.n,null,{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{cols:"3",class:"pa-0"},{default:(0,n.k6)((function(){return[(0,n.bF)(h.$,{modelValue:I.tasks.affiliate.interval,"onUpdate:modelValue":t[4]||(t[4]=function(e){return I.tasks.affiliate.interval=e}),class:"mt-0",density:"comfortable"},{label:(0,n.k6)((function(){return[T]})),default:(0,n.k6)((function(){return[(0,n.bF)(v.i,{value:1440,label:"Every day"}),(0,n.bF)(v.i,{value:10080,label:"Every week"}),(0,n.bF)(v.i,{value:43800,label:"Every month"}),(0,n.bF)(v.i,{value:"custom",label:"Custom"})]})),_:1},8,["modelValue"]),(0,n.bF)(F.W,{modelValue:I.tasks.affiliate.customInterval,"onUpdate:modelValue":t[5]||(t[5]=function(e){return I.tasks.affiliate.customInterval=e}),label:"Every",type:"number",suffix:"minutes",class:"ml-8",density:"compact","hide-details":""},null,8,["modelValue"])]})),_:1})]})),_:1}),I.tasks.affiliate.isActive?((0,n.uX)(),(0,n.Wv)(m.L,{key:0,class:"ma-0 pt-8 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"pa-0"},{default:(0,n.k6)((function(){return[(0,n.bF)(u.D,{color:"primary",variant:"flat",size:"small",onClick:t[6]||(t[6]=function(e){return X.updateScheduledTask("affiliate")})},{default:(0,n.k6)((function(){return[(0,n.eW)(" Update ")]})),_:1})]})),_:1})]})),_:1})):(0,n.Q3)("",!0)]})),_:1})]})),_:1})]})),_:1}),(0,n.bF)(c.c,null,{default:(0,n.k6)((function(){return[(0,n.bF)(o.w,{"aria-label":"Show advanced configuration"},{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 px-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"d-flex flex-column justify-center"},{default:(0,n.k6)((function(){return[S,I.tasks.unify.lastExecution?((0,n.uX)(),(0,n.CE)("span",U,[I.tasks.unify.failed?((0,n.uX)(),(0,n.Wv)(b.w,{key:0,color:"error",left:"",small:""},{default:(0,n.k6)((function(){return[(0,n.eW)(" mdi-alert ")]})),_:1})):((0,n.uX)(),(0,n.Wv)(b.w,{key:1,color:"green",left:"",small:""},{default:(0,n.k6)((function(){return[(0,n.eW)(" mdi-check ")]})),_:1})),(0,n.Lk)("span",W," Last run "+(0,l.v_)(e.$formatDate(I.tasks.unify.lastExecution)),1)])):(0,n.Q3)("",!0)]})),_:1}),(0,n.bF)(k.B,{class:"d-flex justify-end"},{default:(0,n.k6)((function(){return[(0,n.bF)(_.N,{modelValue:I.tasks.unify.isActive,"onUpdate:modelValue":t[7]||(t[7]=function(e){return I.tasks.unify.isActive=e}),color:"primary",density:"comfortable",inset:"","hide-details":"",class:"mt-0",onChange:t[8]||(t[8]=function(e){return X.toggleTask("unify")}),onClick:t[9]||(t[9]=(0,s.D$)((function(){}),["stop"])),onMousedown:t[10]||(t[10]=(0,s.D$)((function(){}),["prevent"]))},{label:(0,n.k6)((function(){return[C]})),_:1},8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.bF)(f.T,null,{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 pt-4 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"pa-0"},{default:(0,n.k6)((function(){return[$]})),_:1})]})),_:1}),(0,n.bF)(d.n,null,{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"pa-0 mb-3"},{default:(0,n.k6)((function(){return[(0,n.bF)(i.a,{modelValue:I.tasks.unify.params.exclude,"onUpdate:modelValue":t[11]||(t[11]=function(e){return I.tasks.unify.params.exclude=e}),label:"Exclude individuals in RecommenderExclusionTerm list",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,n.bF)(i.a,{modelValue:I.tasks.unify.params.strict,"onUpdate:modelValue":t[12]||(t[12]=function(e){return I.tasks.unify.params.strict=e}),label:"Exclude individuals with invalid email addresses and names",density:"comfortable","hide-details":""},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,n.bF)(m.L,{class:"ma-0 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{cols:"3",class:"pa-0 mb-2"},{default:(0,n.k6)((function(){return[j,(0,n.bF)(i.a,{modelValue:I.tasks.unify.params.criteria,"onUpdate:modelValue":t[13]||(t[13]=function(e){return I.tasks.unify.params.criteria=e}),label:"Name",value:"name",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,n.bF)(i.a,{modelValue:I.tasks.unify.params.criteria,"onUpdate:modelValue":t[14]||(t[14]=function(e){return I.tasks.unify.params.criteria=e}),label:"Email",value:"email",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,n.bF)(i.a,{modelValue:I.tasks.unify.params.criteria,"onUpdate:modelValue":t[15]||(t[15]=function(e){return I.tasks.unify.params.criteria=e}),label:"Username",value:"username",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,n.bF)(i.a,{class:"ml-4",modelValue:I.tasks.unify.params.match_source,"onUpdate:modelValue":t[16]||(t[16]=function(e){return I.tasks.unify.params.match_source=e}),label:"Only unify identities that share the same source",density:"comfortable","hide-details":""},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,n.bF)(m.L,{class:"ma-0 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{cols:"3",class:"pa-0"},{default:(0,n.k6)((function(){return[(0,n.bF)(h.$,{modelValue:I.tasks.unify.interval,"onUpdate:modelValue":t[17]||(t[17]=function(e){return I.tasks.unify.interval=e}),class:"mt-0",density:"comfortable"},{label:(0,n.k6)((function(){return[B]})),default:(0,n.k6)((function(){return[(0,n.bF)(v.i,{value:1440,label:"Every day"}),(0,n.bF)(v.i,{value:10080,label:"Every week"}),(0,n.bF)(v.i,{value:43800,label:"Every month"}),(0,n.bF)(v.i,{value:"custom",label:"Custom"})]})),_:1},8,["modelValue"]),(0,n.bF)(F.W,{modelValue:I.tasks.unify.customInterval,"onUpdate:modelValue":t[18]||(t[18]=function(e){return I.tasks.unify.customInterval=e}),label:"Every",type:"number",suffix:"minutes",class:"ml-8",density:"compact","hide-details":""},null,8,["modelValue"])]})),_:1})]})),_:1}),I.tasks.unify.isActive?((0,n.uX)(),(0,n.Wv)(m.L,{key:0,class:"ma-0 pt-8 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"pa-0"},{default:(0,n.k6)((function(){return[(0,n.bF)(u.D,{color:"primary",variant:"flat",size:"small",onClick:t[19]||(t[19]=function(e){return X.updateScheduledTask("unify")})},{default:(0,n.k6)((function(){return[(0,n.eW)(" Update ")]})),_:1})]})),_:1})]})),_:1})):(0,n.Q3)("",!0)]})),_:1})]})),_:1})]})),_:1})]})),_:1})),(0,n.bF)(y.K,{modelValue:I.snackbar.isActive,"onUpdate:modelValue":t[20]||(t[20]=function(e){return I.snackbar.isActive=e}),color:I.snackbar.color,timeout:"4000",text:""},{default:(0,n.k6)((function(){return[(0,n.eW)((0,l.v_)(I.snackbar.text),1)]})),_:1},8,["modelValue","color"])])}var X=a(14048),D=a(30388),O=(a(50113),a(60739),a(33110),a(26099),a(58663)),N=a(20595);const Q={name:"SettingsGeneral",data:function(){return{isLoading:!0,tasks:{affiliate:{isActive:!1,interval:10080,customInterval:"",failed:!1,lastExecution:null,id:null,params:{}},unify:{isActive:!1,interval:10080,failed:!1,lastExecution:null,id:null,params:{criteria:["name","email","username"],exclude:!0,strict:!0,match_source:!1}}},snackbar:{isActive:!1,text:"",color:"success"}}},methods:{fetchScheduledTasks:function(){var e=this;return(0,D.A)((0,X.A)().mark((function t(){var a,n,l,s;return(0,X.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.next=3,(0,O.GS)(e.$apollo);case 3:a=t.sent,n=a.data.scheduledTasks.entities,l=n.find((function(e){return"affiliate"===e.jobType})),s=n.find((function(e){return"unify"===e.jobType})),l&&e.buildForm(l),s&&e.buildForm(s),e.isLoading=!1;case 10:case"end":return t.stop()}}),t)})))()},buildForm:function(e){var t=[1440,10080,43800],a=t.find((function(t){return t===e.interval}))?e.interval:"custom";Object.assign(this.tasks[e.jobType],{isActive:!0,interval:a,failed:e.failed,lastExecution:e.lastExecution,id:e.id,customInterval:e.interval,params:e.args})},toggleTask:function(e){this.tasks[e].isActive?this.createTask(e):this.deleteScheduledTask(e)},createTask:function(e){var t=this;return(0,D.A)((0,X.A)().mark((function a(){var n,l;return(0,X.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n="custom"===t.tasks[e].interval?t.tasks[e].customInterval:t.tasks[e].interval,a.next=3,(0,N.nD)(t.$apollo,e,n,JSON.stringify(t.tasks[e].params))["catch"]((function(a){t.openSnackbar(a),t.tasks[e].isActive=!1}));case 3:l=a.sent,Object.assign(t.tasks[e],{isActive:!0,id:l.data.scheduleTask.task.id,lastExecution:l.data.scheduleTask.task.lastExecution,failed:l.data.scheduleTask.task.failed}),t.openSnackbar();case 6:case"end":return a.stop()}}),a)})))()},deleteScheduledTask:function(e){var t=this;return(0,D.A)((0,X.A)().mark((function a(){var n;return(0,X.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,N.vq)(t.$apollo,t.tasks[e].id)["catch"]((function(e){return t.openSnackbar(e)}));case 2:n=a.sent,n.data.deleteScheduledTask.deleted&&(Object.assign(t.tasks[e],{isActive:!1,id:null,lastExecution:null,failed:null}),t.openSnackbar());case 4:case"end":return a.stop()}}),a)})))()},updateScheduledTask:function(e){var t=this;return(0,D.A)((0,X.A)().mark((function a(){var n,l;return(0,X.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n="custom"===t.tasks[e].interval?t.tasks[e].customInterval:t.tasks[e].interval,l={interval:n,params:JSON.stringify(t.tasks[e].params)},a.next=4,(0,N.lC)(t.$apollo,t.tasks[e].id,l)["catch"]((function(e){return t.openSnackbar(e)}));case 4:t.openSnackbar();case 5:case"end":return a.stop()}}),a)})))()},openSnackbar:function(e){var t=e?"Error saving settings: ".concat(this.$getErrorMessage(e)):"Changes saved successfully";Object.assign(this.snackbar,{isActive:!0,text:t,color:e?"error":"success"})}},mounted:function(){var e=this;return(0,D.A)((0,X.A)().mark((function t(){return(0,X.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchScheduledTasks();case 2:case"end":return t.stop()}}),t)})))()}};var z=a(64621);const G=(0,z.A)(Q,[["render",I],["__scopeId","data-v-694a9ab3"]]),M=G}}]);
//# sourceMappingURL=748.dd5427e8.js.map