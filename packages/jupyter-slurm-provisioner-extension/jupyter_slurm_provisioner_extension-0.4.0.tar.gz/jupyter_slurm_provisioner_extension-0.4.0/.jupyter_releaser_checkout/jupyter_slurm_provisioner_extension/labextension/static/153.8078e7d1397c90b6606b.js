"use strict";(self.webpackChunkjupyter_slurm_provisioner_extension=self.webpackChunkjupyter_slurm_provisioner_extension||[]).push([[153],{153:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var a=n(169),s=n(434),i=n(856),r=n(923),o=n(19),l=n(579);async function c(e="",t={}){const n=l.ServerConnection.makeSettings(),a=o.URLExt.join(n.baseUrl,"slurm-provisioner",e);let s;try{s=await l.ServerConnection.makeRequest(a,t,n)}catch(e){throw new l.ServerConnection.NetworkError(e)}let i=await s.text();if(i.length>0)try{i=JSON.parse(i)}catch(e){console.log("Not a JSON response body.",s)}if(!s.ok)throw new l.ServerConnection.ResponseError(s,i.message||i);return i}async function d(){let e={dropdown_lists:{},resources:{},allocations:{},documentationhref:""};return await c("configure").then((t=>{e=t})).catch((e=>{console.error(`Slurm-Configurator: Could not receive OptionsForm for user.\n${e}`)})),e}var p=n(271);class h extends a.ReactWidget{constructor(e,t){super(),this.config_system=e,this.available_kernels=t,this.slurmelRef=p.createRef()}getValue(){const e=this.slurmelRef.current.state,t=this.available_kernels[e.kernel][1],n=this.available_kernels[e.kernel][2];let a="",s="";return a="New"===e.allocation?"None":e.allocation,s="Any"===e.allocation_node?"None":e.allocation_node,{allocation:a,node:s,kernel_argv:t,kernel_language:n,project:e.project,partition:e.partition,nodes:e.nodes,gpus:e.gpus,runtime:e.runtime,name:"custom"}}render(){return p.createElement(m,{config_system:this.config_system,available_kernels:this.available_kernels,ref:this.slurmelRef})}}class m extends p.Component{constructor(e){super(e),this.handleDropdownChange=this.handleDropdownChange.bind(this),this.handleAllocationChange=this.handleAllocationChange.bind(this),this.handleNodeChange=this.handleNodeChange.bind(this),this.handleKernelChange=this.handleKernelChange.bind(this),this.handleNumberChange=this.handleNumberChange.bind(this),this.state=this.default_values(e)}default_values(e,{resources_editable:t=!0,project:n="",partition:a="",nodes:s="",gpus:i="",runtime:r="",reservation:o="",allocation:l="",kernel:c="",date_show:d=!1,date_endtime:p="",allocation_node:h=""}={}){const m=e.config_system.dropdown_lists;let v=m.projects;""===n&&(n=v.length>0?v[0]:"");const u=v.includes(n)?v:[n];v=m.partitions[n],""===a&&(a=v&&v.length>0?v[0]:"");const g=v&&v.includes(a)?v:[a],f=e.config_system.resources[a];""===s&&(s=f&&f.nodes?f.nodes.default:"0");const _=f&&f.nodes?f.nodes.minmax[0]:"0",w=f&&f.nodes?f.nodes.minmax[1]:"0";""===i&&(i=f&&f.gpus?f.gpus.default:"0");const k=f&&f.gpus?f.gpus.minmax[0]:"0",y=f&&f.gpus?f.gpus.minmax[1]:"0";""===r&&(r=f&&f.runtime?f.runtime.default:"0");const b=f&&f.runtime?f.runtime.minmax[0]:"0",x=f&&f.runtime?f.runtime.minmax[1]:"0";""===o&&(o="None"),v=m.reservations;const C=n in v&&a in m.reservations[n]?m.reservations[n][a]:["None"];""===l&&(l="New");let S=["New"];for(let t in e.config_system.allocations)S.push(t);""===h&&(h="Any");let z=["Any"];if("New"!=l){let t=e.config_system.allocations[l];t.nodelist&&(z=z.concat(t.nodelist))}let N=[];for(let t in e.available_kernels)N.push(t);return""===c&&(c=String(N[0])),"New"===l&&(d=!1),d&&""==p&&(p=e.config_system.allocations[l].endtime),{resources_editable:t,project:n,projects:u,partition:a,partitions:g,nodes:s,nodes_min:_,nodes_max:w,gpus:i,gpus_min:k,gpus_max:y,runtime:r,runtime_min:b,runtime_max:x,reservation:o,reservations:C,kernel:c,kernel_names:N,allocation:l,allocation_names:S,date_show:d,date_endtime:p,allocation_node:h,allocation_node_names:z}}handleAllocationChange(e,t){if("New"==t)this.state.allocation!=t&&this.setState(this.default_values(this.props,{kernel:this.state.kernel}));else{const e=this.props.config_system.allocations[t].config,n=e.project,a=e.partition,s=e.gpus?e.gpus:"",i=e.nodes?e.nodes:"",r=e.runtime?e.runtime:"",o=e.reservation,l=this.props.config_system.allocations[t].endtime;this.setState(this.default_values(this.props,{resources_editable:!1,project:n,partition:a,nodes:i,gpus:s,runtime:r,reservation:o,allocation:t,allocation_node:"Any",kernel:this.state.kernel,date_show:!0,date_endtime:l}))}}handleNodeChange(e,t){this.setState({node:t})}handleKernelChange(e,t){this.setState({kernel:t})}handleDropdownChange(e,t){const n=this.props.config_system.dropdown_lists;let a=this.state.project,s=this.state.partition;if("partitions"===e)s=t,this.setState({partition:s});else if("projects"===e){a=t,this.setState({project:a});const e=n.partitions[a];s=e[0],this.setState({partition:s,partitions:e})}"reservations"===e?this.setState({reservation:t}):this.setState(this.default_values(this.props,{project:a,partition:s,allocation:this.state.allocation,kernel:this.state.kernel,date_show:this.state.date_show,date_endtime:this.state.date_endtime}))}validateNumber(e){try{if(isNaN(parseInt(e)))return console.log("Only positive numbers are allowed in nodes field."),!1;if(e.includes("."))return console.log("Only positive numbers are allowed in nodes field."),!1}catch(e){return console.log("Only positive numbers are allowed in nodes field."),!1}return!0}handleNumberChange(e,t){const n=this.state.partition;let a="0";if("runtime"===e)a=this.props.config_system.resources[n].runtime.minmax[1];else if("nodes"==e)a=this.props.config_system.resources[n].nodes.minmax[1];else{if("gpus"!=e)return void console.log("Unsupported key: "+e);a=this.props.config_system.resources[n].gpus.minmax[1]}parseInt(t)>parseInt(a)&&(t=a.toString()),this.setState({[e]:t})}render(){const e=p.createElement(u,{label:"Select allocation for slurm wrapper",key_:"allocations",selected:this.state.allocation,values:this.state.allocation_names,onValueChange:this.handleAllocationChange,editable:!0,available_kernels:{}}),t=p.createElement(u,{label:"Select node for slurm wrapper",key_:"allocations_nodes",selected:this.state.allocation_node,values:this.state.allocation_node_names,onValueChange:this.handleNodeChange,editable:!0,available_kernels:{}}),n=p.createElement(u,{label:"Select kernel for slurm wrapper",key_:"kernels",selected:this.state.kernel,values:this.state.kernel_names,onValueChange:this.handleKernelChange,editable:!0,available_kernels:this.props.available_kernels}),a=p.createElement(u,{label:"Select project for slurm wrapper",key_:"projects",selected:this.state.project,values:this.state.projects,onValueChange:this.handleDropdownChange,editable:this.state.resources_editable,available_kernels:{}}),s=p.createElement(u,{label:"Select partition for slurm wrapper",key_:"partitions",selected:this.state.partition,values:this.state.partitions,onValueChange:this.handleDropdownChange,editable:this.state.resources_editable,available_kernels:{}}),i=p.createElement(u,{label:"Select reservation for slurm wrapper",key_:"reservations",selected:this.state.reservation,values:this.state.reservations,onValueChange:this.handleDropdownChange,editable:this.state.resources_editable,available_kernels:{}}),r=p.createElement(g,{label:"Nodes",key_:"nodes",value:this.state.nodes,min:this.state.nodes_min,max:this.state.nodes_max,onValueChange:this.handleNumberChange,editable:this.state.resources_editable}),o=p.createElement(g,{label:"GPUs",key_:"gpus",value:this.state.gpus,min:this.state.gpus_min,max:this.state.gpus_max,onValueChange:this.handleNumberChange,editable:this.state.resources_editable}),l=p.createElement(g,{label:"Runtime (min)",key_:"runtime",value:this.state.runtime,min:this.state.runtime_min,max:this.state.runtime_max,onValueChange:this.handleNumberChange,editable:this.state.resources_editable}),c=p.createElement(v,{key_:"timer",date_label:"Time left: ",date_endtime:this.state.date_endtime,date_show:this.state.date_show}),d={minWidth:"450px",overflow:"auto"};return this.state.date_show?p.createElement("span",{style:d},c,e,t,n,a,s,r,o,l,i):p.createElement("span",{style:d},e,n,a,s,r,o,l,i)}}class v extends p.Component{constructor(e){super(e),this.state=this.get_time_values()}componentDidMount(){this.timerID=setInterval((()=>this.tick()),1e3)}componentWillUnmount(){clearInterval(this.timerID)}get_time_values(){const e=Math.floor((new Date).getTime()/1e3),t=Math.floor(this.props.date_endtime/1)-e,n=String(Math.floor(t%86400/3600)),a=String(Math.floor(t%3600/60)),s=String(Math.floor(t%60));return{distance:String(t),hours:n,minutes:a,seconds:s}}tick(){this.setState(this.get_time_values())}render(){var e;let t={alignSelf:"center",flex:"8 1 0",color:"black"};parseInt(this.state.distance)<300&&(t.color="red");const n="0"+this.state.minutes,a=n.substring(n.length-2),s="0"+this.state.seconds,i=s.substring(s.length-2);return(null===(e=this.props)||void 0===e?void 0:e.date_show)?p.createElement("div",null,p.createElement("div",{className:"lm-Widget p-Widget jp-Dialog-body"},p.createElement("label",{style:{display:"flex"}},p.createElement("span",{style:t},this.props.date_label,this.state.hours,":",a,":",i)))):null}}class u extends p.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.onValueChange(this.props.key_,e.target.value)}render(){if("reservations"===this.props.key_&&this.props.values.length<2)return null;const e=this.props.selected,t=this.props.values;let n={};return n="kernels"===this.props.key_?t.map((t=>t===e?p.createElement("option",{value:t,selected:!0},this.props.available_kernels[t][0]):p.createElement("option",{value:t},this.props.available_kernels[t][0]))):t.map((t=>t===e?p.createElement("option",{selected:!0},t):p.createElement("option",null,t))),p.createElement("div",null,p.createElement("div",{className:"lm-Widget p-Widget jp-Dialog-body"},p.createElement("label",null,this.props.label," :"),p.createElement("div",{className:"jp-select-wrapper"},p.createElement("select",{className:"jp-mod-styled",key:this.props.key_,disabled:!this.props.editable,name:this.props.key_,onChange:this.handleChange},n))))}}class g extends p.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.onValueChange(this.props.key_,e.target.value)}render(){return"gpus"===this.props.key_&&"0"===this.props.value?null:p.createElement("div",null,p.createElement("div",{className:"lm-Widget p-Widget jp-Dialog-body"},p.createElement("label",{style:{display:"flex"}},p.createElement("span",{style:{alignSelf:"center",flex:"8 1 0"}},this.props.label," [",this.props.min,"-",this.props.max,"]: "),p.createElement("input",{style:{marginLeft:"20px",maxWidth:"100px"},className:"jp-mod-styled",type:"number",disabled:!this.props.editable,key:this.props.key_,id:this.props.key_,name:this.props.key_,value:this.props.value,min:this.props.min,max:this.props.max,onChange:this.handleChange}))))}}var f=n(978);const _=new f.LabIcon({name:"launcher:slurmel",svgstr:'<svg\n   width="40"\n   height="40"\n   version="1.1"\n   id="svg842"\n   sodipodi:docname="Slurm_logo.svg"\n   inkscape:version="1.1.2 (b8e25be833, 2022-02-05)"\n   viewBox="0 0 40 40"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:xlink="http://www.w3.org/1999/xlink"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg">\n  <defs\n     id="defs846">\n    <linearGradient\n       inkscape:collect="always"\n       xlink:href="#linearGradient4689"\n       id="linearGradient1478"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(1.7201279,0,0,1.7367347,-45.8396,-35.783308)"\n       x1="26.648937"\n       y1="20.603781"\n       x2="135.66525"\n       y2="114.39767" />\n    <linearGradient\n       id="linearGradient4689">\n      <stop\n         style="stop-color:#5a9fd4;stop-opacity:1;"\n         offset="0"\n         id="stop4691" />\n      <stop\n         style="stop-color:#306998;stop-opacity:1;"\n         offset="1"\n         id="stop4693" />\n    </linearGradient>\n    <linearGradient\n       inkscape:collect="always"\n       xlink:href="#linearGradient4671"\n       id="linearGradient1475"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(1.7166332,0,0,1.7332063,65.036885,71.326052)"\n       x1="150.96111"\n       y1="192.35176"\n       x2="112.03144"\n       y2="137.27299" />\n    <linearGradient\n       id="linearGradient4671">\n      <stop\n         style="stop-color:#ffd43b;stop-opacity:1;"\n         offset="0"\n         id="stop4673" />\n      <stop\n         style="stop-color:#ffe873;stop-opacity:1"\n         offset="1"\n         id="stop4675" />\n    </linearGradient>\n  </defs>\n  <sodipodi:namedview\n     id="namedview844"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:pageshadow="2"\n     inkscape:pageopacity="0.0"\n     inkscape:pagecheckerboard="0"\n     showgrid="false"\n     inkscape:zoom="16.716418"\n     inkscape:cx="14.207589"\n     inkscape:cy="9.0031249"\n     inkscape:window-width="1920"\n     inkscape:window-height="1051"\n     inkscape:window-x="-9"\n     inkscape:window-y="-9"\n     inkscape:window-maximized="1"\n     inkscape:current-layer="svg842" />\n  <g\n     id="g1421"\n     transform="scale(0.08888889)">\n    <path\n       fill="#42afeb"\n       d="m 217.79209,173.05964 c -3.91294,0 -7.08401,3.14839 -7.08401,7.03332 v 0 13.53739 c 0,3.8822 3.17107,7.03436 7.08401,7.03436 v 0 h 14.07039 c 3.91295,0 7.08917,-3.15216 7.08917,-7.03436 v 0 -13.53739 c 0,-3.88493 -3.17622,-7.03332 -7.08917,-7.03332 v 0 z m 34.58434,21.41998 c -2.93919,0 -5.32283,2.4077 -5.32283,5.36973 v 0 10.33007 c 0,2.96509 2.38364,5.3711 5.32283,5.3711 v 0 h 10.57151 c 2.93953,0 5.32111,-2.40601 5.32111,-5.3711 v 0 -10.33007 c 0,-2.96203 -2.38158,-5.36973 -5.32111,-5.36973 v 0 z m -65.67012,0 c -2.93817,0 -5.32216,2.4077 -5.32216,5.36973 v 0 10.33007 c 0,2.96509 2.38399,5.3711 5.32216,5.3711 v 0 h 10.5708 c 2.93781,0 5.32283,-2.40601 5.32283,-5.3711 v 0 -10.33007 c 0,-2.96203 -2.38502,-5.36973 -5.32283,-5.36973 v 0 z m 31.08578,11.84875 c -3.91294,0 -7.08401,3.14668 -7.08401,7.03403 v 0 13.53634 c 0,3.88425 3.17107,7.03538 7.08401,7.03538 v 0 h 14.07039 c 3.91295,0 7.08917,-3.15113 7.08917,-7.03538 v 0 -13.53634 c 0,-3.88735 -3.17622,-7.03403 -7.08917,-7.03403 v 0 z m 61.77894,6.3461 c -2.18592,0 -3.95779,1.78763 -3.95779,3.99527 v 0 7.6846 c 0,2.20284 1.77187,3.99184 3.95779,3.99184 v 0 h 7.86453 c 2.18456,0 3.9578,-1.789 3.9578,-3.99184 v 0 -7.6846 c 0,-2.20764 -1.77324,-3.99527 -3.9578,-3.99527 v 0 z m -117.00486,0 c -2.18528,0 -3.95919,1.78763 -3.95919,3.99527 v 0 7.6846 c 0,2.20284 1.77391,3.99184 3.95919,3.99184 v 0 h 7.86208 c 2.18802,0 3.95987,-1.789 3.95987,-3.99184 v 0 -7.6846 c 0,-2.20764 -1.77185,-3.99527 -3.95987,-3.99527 v 0 z m 89.81026,8.08783 c -2.93919,0 -5.32283,2.40394 -5.32283,5.3663 v 0 10.33349 c 0,2.96271 2.38364,5.36766 5.32283,5.36766 v 0 h 10.57151 c 2.93953,0 5.32111,-2.40495 5.32111,-5.36766 v 0 -10.33349 c 0,-2.96236 -2.38158,-5.3663 -5.32111,-5.3663 v 0 z m -65.67012,0 c -2.93817,0 -5.32216,2.40394 -5.32216,5.3663 v 0 10.33349 c 0,2.96271 2.38399,5.36766 5.32216,5.36766 v 0 h 10.5708 c 2.93781,0 5.32283,-2.40495 5.32283,-5.36766 v 0 -10.33349 c 0,-2.96236 -2.38502,-5.3663 -5.32283,-5.3663 v 0 z m 92.86472,13.01732 c -2.18592,0 -3.95779,1.78659 -3.95779,3.99149 v 0 7.68494 c 0,2.20319 1.77187,3.99252 3.95779,3.99252 v 0 h 7.86453 c 2.18456,0 3.9578,-1.78933 3.9578,-3.99252 v 0 -7.68494 c 0,-2.2049 -1.77324,-3.99149 -3.9578,-3.99149 v 0 z m -117.00486,0 c -2.18528,0 -3.95919,1.78659 -3.95919,3.99149 v 0 7.68494 c 0,2.20319 1.77391,3.99252 3.95919,3.99252 v 0 h 7.86208 c 2.18802,0 3.95987,-1.78933 3.95987,-3.99252 v 0 -7.68494 c 0,-2.2049 -1.77185,-3.99149 -3.95987,-3.99149 v 0 z m 55.22592,5.528 c -3.91294,0 -7.08401,3.14975 -7.08401,7.03505 v 0 13.53736 c 0,3.88462 3.17107,7.03199 7.08401,7.03199 v 0 h 14.07039 c 3.91295,0 7.08917,-3.14737 7.08917,-7.03199 v 0 -13.53736 c 0,-3.8853 -3.17622,-7.03505 -7.08917,-7.03505 v 0 z m 85.02057,5.78359 c -1.62555,0 -2.94057,1.32854 -2.94057,2.96508 v 0 5.70443 c 0,1.63654 1.31502,2.96272 2.94057,2.96272 v 0 H 308.65 c 1.62072,0 2.93469,-1.32618 2.93469,-2.96272 v 0 -5.70443 c 0,-1.63654 -1.31397,-2.96508 -2.93469,-2.96508 v 0 z m -161.45955,0 c -1.62317,0 -2.93816,1.32854 -2.93816,2.96508 v 0 5.70443 c 0,1.63654 1.31499,2.96272 2.93816,2.96272 v 0 h 5.83491 c 1.62418,0 2.93885,-1.32618 2.93885,-2.96272 v 0 -5.70443 c 0,-1.63654 -1.31467,-2.96508 -2.93885,-2.96508 v 0 z m 111.02332,1.95856 c -2.93919,0 -5.32283,2.40223 -5.32283,5.36527 v 0 10.33144 c 0,2.96509 2.38364,5.36938 5.32283,5.36938 v 0 h 10.57151 c 2.93953,0 5.32111,-2.40429 5.32111,-5.36938 v 0 -10.33144 c 0,-2.96304 -2.38158,-5.36527 -5.32111,-5.36527 v 0 z m -65.67012,0 c -2.93817,0 -5.32216,2.40223 -5.32216,5.36527 v 0 10.33144 c 0,2.96509 2.38399,5.36938 5.32216,5.36938 v 0 h 10.5708 c 2.93781,0 5.32283,-2.40429 5.32283,-5.36938 v 0 -10.33144 c 0,-2.96304 -2.38502,-5.36527 -5.32283,-5.36527 v 0 z m 92.86472,7.99259 c -2.18592,0 -3.95779,1.79139 -3.95779,3.99834 v 0 7.68288 c 0,2.20729 1.77187,3.99184 3.95779,3.99184 v 0 h 7.86453 c 2.18456,0 3.9578,-1.78455 3.9578,-3.99184 v 0 -7.68288 c 0,-2.20695 -1.77324,-3.99834 -3.9578,-3.99834 v 0 z m -117.00486,0 c -2.18528,0 -3.95919,1.79139 -3.95919,3.99834 v 0 7.68288 c 0,2.20729 1.77391,3.99184 3.95919,3.99184 v 0 h 7.86208 c 2.18802,0 3.95987,-1.78455 3.95987,-3.99184 v 0 -7.68288 c 0,-2.20695 -1.77185,-3.99834 -3.95987,-3.99834 v 0 z m 140.24649,7.42285 c -1.62555,0 -2.94057,1.3272 -2.94057,2.96374 v 0 5.70443 c 0,1.63346 1.31502,2.9651 2.94057,2.9651 v 0 H 308.65 c 1.62072,0 2.93469,-1.33164 2.93469,-2.9651 v 0 -5.70443 c 0,-1.63654 -1.31397,-2.96374 -2.93469,-2.96374 v 0 z m -161.45955,0 c -1.62317,0 -2.93816,1.3272 -2.93816,2.96374 v 0 5.70443 c 0,1.63346 1.31499,2.9651 2.93816,2.9651 v 0 h 5.83491 c 1.62418,0 2.93885,-1.33164 2.93885,-2.9651 v 0 -5.70443 c 0,-1.63654 -1.31467,-2.96374 -2.93885,-2.96374 v 0 z m 180.73096,5.69999 c -1.22528,0 -2.22078,1.00103 -2.22078,2.23642 v 0 4.30358 c 0,1.23161 0.9955,2.23471 2.22078,2.23471 v 0 h 4.40293 c 1.22048,0 2.21526,-1.0031 2.21526,-2.23471 v 0 -4.30358 c 0,-1.23539 -0.99478,-2.23642 -2.21526,-2.23642 v 0 z m -198.56763,0 c -1.22461,0 -2.21872,1.00103 -2.21872,2.23642 v 0 4.30358 c 0,1.23161 0.99411,2.23471 2.21872,2.23471 v 0 h 4.40016 c 1.22494,0 2.2163,-1.0031 2.2163,-2.23471 v 0 -4.30358 c 0,-1.23539 -0.99136,-2.23642 -2.2163,-2.23642 v 0 z"\n       id="path836"\n       style="stroke-width:0.389833" />\n    <g\n       id="g1400">\n      <path\n         style="fill:url(#linearGradient1478);fill-opacity:1;stroke-width:3.05778"\n         d="M 167.92969,0.00281082 C 153.91385,0.06793434 140.52908,1.2632881 128.75185,3.3472609 94.057586,9.4765819 87.758461,22.305815 87.758461,45.965099 V 77.211816 H 169.74524 V 87.627382 H 87.758461 56.98953 c -23.827649,0 -44.691815,14.321798 -51.2178462,41.566738 -7.5277182,31.229 -7.8616278,50.71643 0,83.32456 5.8278802,24.2722 19.7457432,41.56673 43.5733922,41.56673 h 28.188922 v -37.45783 c 0,-27.06107 23.413862,-50.9312 51.217852,-50.9312 h 81.89123 c 22.79561,0 40.99339,-18.76918 40.99339,-41.66228 V 45.965099 c 0,-22.218887 -18.74415,-38.9096022 -40.99339,-42.6178381 C 196.55897,1.0027638 181.94549,-0.0623127 167.92969,0.00281082 Z M 123.59184,25.133957 c 8.46866,0 15.38447,7.02878 15.38447,15.671135 -3e-5,8.611724 -6.91581,15.575583 -15.38447,15.575583 -8.49904,0 -15.38446,-6.963859 -15.38446,-15.575583 -3e-5,-8.642355 6.88542,-15.671135 15.38446,-15.671135 z"\n         id="path1948" />\n      <path\n         style="fill:url(#linearGradient1475);fill-opacity:1;stroke-width:3.05157"\n         d="m 372.11228,194.486 v 36.33276 c 0,28.16828 -23.88128,51.87669 -51.11379,51.87669 h -81.72487 c -22.38583,0 -40.91011,19.15922 -40.91011,41.57764 v 77.9104 c 0,22.17374 19.28159,35.21609 40.91011,41.57764 25.89969,7.61553 50.73611,8.99185 81.72487,0 20.59855,-5.96395 40.9101,-17.96645 40.9101,-41.57764 v -31.18324 h -81.72486 v -10.3944 h 81.72486 40.91011 c 23.77924,0 32.64036,-16.58653 40.91008,-41.48229 8.54236,-25.6298 8.17888,-50.27698 0,-83.15527 C 437.85213,212.29592 426.62818,194.486 402.8187,194.486 Z m -45.96427,197.30308 c 8.48175,0 15.35321,6.94971 15.35321,15.54394 -3e-5,8.6248 -6.87146,15.63929 -15.35321,15.63929 -8.45151,0 -15.35321,-7.01449 -15.35321,-15.63929 0,-8.59423 6.9017,-15.54394 15.35321,-15.54394 z"\n         id="path1950" />\n    </g>\n  </g>\n</svg>\n'}),w=new f.LabIcon({name:"launcher:slurmel2",svgstr:'<svg\n   width="40.000004"\n   height="40"\n   viewBox="0 0 10.583334 10.583334"\n   version="1.1"\n   id="svg873"\n   inkscape:version="1.1.2 (b8e25be833, 2022-02-05)"\n   sodipodi:docname="drawing.svg"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:xlink="http://www.w3.org/1999/xlink"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg">\n  <sodipodi:namedview\n     id="namedview875"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:pageshadow="2"\n     inkscape:pageopacity="0.0"\n     inkscape:pagecheckerboard="0"\n     inkscape:document-units="mm"\n     showgrid="false"\n     fit-margin-top="0"\n     fit-margin-left="0"\n     fit-margin-right="0"\n     fit-margin-bottom="0"\n     units="px"\n     inkscape:zoom="0.76435185"\n     inkscape:cx="-8.503937"\n     inkscape:cy="202.13204"\n     inkscape:window-width="1920"\n     inkscape:window-height="1051"\n     inkscape:window-x="-9"\n     inkscape:window-y="-9"\n     inkscape:window-maximized="1"\n     inkscape:current-layer="layer1" />\n  <defs\n     id="defs870">\n    <linearGradient\n       inkscape:collect="always"\n       xlink:href="#linearGradient4679"\n       id="linearGradient1468"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(1.7201279,0,0,1.7367347,-45.8396,-35.783308)"\n       x1="26.648937"\n       y1="20.603781"\n       x2="135.66525"\n       y2="114.39767" />\n    <linearGradient\n       id="linearGradient4679">\n      <stop\n         style="stop-color:#5a9fd4;stop-opacity:1;"\n         offset="0"\n         id="stop4681" />\n      <stop\n         style="stop-color:#306998;stop-opacity:1;"\n         offset="1"\n         id="stop4683" />\n    </linearGradient>\n    <linearGradient\n       inkscape:collect="always"\n       xlink:href="#linearGradient4661"\n       id="linearGradient1465"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(1.7166332,0,0,1.7332063,65.036885,71.326052)"\n       x1="150.96111"\n       y1="192.35176"\n       x2="112.03144"\n       y2="137.27299" />\n    <linearGradient\n       id="linearGradient4661">\n      <stop\n         style="stop-color:#ffd43b;stop-opacity:1;"\n         offset="0"\n         id="stop4663" />\n      <stop\n         style="stop-color:#ffe873;stop-opacity:1"\n         offset="1"\n         id="stop4665" />\n    </linearGradient>\n  </defs>\n  <g\n     inkscape:label="Layer 1"\n     inkscape:groupmode="layer"\n     id="layer1"\n     transform="translate(-107.20833,-95.092954)">\n    <g\n       id="g1411"\n       transform="matrix(0.02351852,0,0,0.02351852,107.20833,95.092954)">\n      <path\n         fill="#42afeb"\n         d="m 217.79209,173.05964 c -3.91294,0 -7.08401,3.14839 -7.08401,7.03332 v 0 13.53739 c 0,3.8822 3.17107,7.03436 7.08401,7.03436 v 0 h 14.07039 c 3.91295,0 7.08917,-3.15216 7.08917,-7.03436 v 0 -13.53739 c 0,-3.88493 -3.17622,-7.03332 -7.08917,-7.03332 v 0 z m 34.58434,21.41998 c -2.93919,0 -5.32283,2.4077 -5.32283,5.36973 v 0 10.33007 c 0,2.96509 2.38364,5.3711 5.32283,5.3711 v 0 h 10.57151 c 2.93953,0 5.32111,-2.40601 5.32111,-5.3711 v 0 -10.33007 c 0,-2.96203 -2.38158,-5.36973 -5.32111,-5.36973 v 0 z m -65.67012,0 c -2.93817,0 -5.32216,2.4077 -5.32216,5.36973 v 0 10.33007 c 0,2.96509 2.38399,5.3711 5.32216,5.3711 v 0 h 10.5708 c 2.93781,0 5.32283,-2.40601 5.32283,-5.3711 v 0 -10.33007 c 0,-2.96203 -2.38502,-5.36973 -5.32283,-5.36973 v 0 z m 31.08578,11.84875 c -3.91294,0 -7.08401,3.14668 -7.08401,7.03403 v 0 13.53634 c 0,3.88425 3.17107,7.03538 7.08401,7.03538 v 0 h 14.07039 c 3.91295,0 7.08917,-3.15113 7.08917,-7.03538 v 0 -13.53634 c 0,-3.88735 -3.17622,-7.03403 -7.08917,-7.03403 v 0 z m 61.77894,6.3461 c -2.18592,0 -3.95779,1.78763 -3.95779,3.99527 v 0 7.6846 c 0,2.20284 1.77187,3.99184 3.95779,3.99184 v 0 h 7.86453 c 2.18456,0 3.9578,-1.789 3.9578,-3.99184 v 0 -7.6846 c 0,-2.20764 -1.77324,-3.99527 -3.9578,-3.99527 v 0 z m -117.00486,0 c -2.18528,0 -3.95919,1.78763 -3.95919,3.99527 v 0 7.6846 c 0,2.20284 1.77391,3.99184 3.95919,3.99184 v 0 h 7.86208 c 2.18802,0 3.95987,-1.789 3.95987,-3.99184 v 0 -7.6846 c 0,-2.20764 -1.77185,-3.99527 -3.95987,-3.99527 v 0 z m 89.81026,8.08783 c -2.93919,0 -5.32283,2.40394 -5.32283,5.3663 v 0 10.33349 c 0,2.96271 2.38364,5.36766 5.32283,5.36766 v 0 h 10.57151 c 2.93953,0 5.32111,-2.40495 5.32111,-5.36766 v 0 -10.33349 c 0,-2.96236 -2.38158,-5.3663 -5.32111,-5.3663 v 0 z m -65.67012,0 c -2.93817,0 -5.32216,2.40394 -5.32216,5.3663 v 0 10.33349 c 0,2.96271 2.38399,5.36766 5.32216,5.36766 v 0 h 10.5708 c 2.93781,0 5.32283,-2.40495 5.32283,-5.36766 v 0 -10.33349 c 0,-2.96236 -2.38502,-5.3663 -5.32283,-5.3663 v 0 z m 92.86472,13.01732 c -2.18592,0 -3.95779,1.78659 -3.95779,3.99149 v 0 7.68494 c 0,2.20319 1.77187,3.99252 3.95779,3.99252 v 0 h 7.86453 c 2.18456,0 3.9578,-1.78933 3.9578,-3.99252 v 0 -7.68494 c 0,-2.2049 -1.77324,-3.99149 -3.9578,-3.99149 v 0 z m -117.00486,0 c -2.18528,0 -3.95919,1.78659 -3.95919,3.99149 v 0 7.68494 c 0,2.20319 1.77391,3.99252 3.95919,3.99252 v 0 h 7.86208 c 2.18802,0 3.95987,-1.78933 3.95987,-3.99252 v 0 -7.68494 c 0,-2.2049 -1.77185,-3.99149 -3.95987,-3.99149 v 0 z m 55.22592,5.528 c -3.91294,0 -7.08401,3.14975 -7.08401,7.03505 v 0 13.53736 c 0,3.88462 3.17107,7.03199 7.08401,7.03199 v 0 h 14.07039 c 3.91295,0 7.08917,-3.14737 7.08917,-7.03199 v 0 -13.53736 c 0,-3.8853 -3.17622,-7.03505 -7.08917,-7.03505 v 0 z m 85.02057,5.78359 c -1.62555,0 -2.94057,1.32854 -2.94057,2.96508 v 0 5.70443 c 0,1.63654 1.31502,2.96272 2.94057,2.96272 v 0 H 308.65 c 1.62072,0 2.93469,-1.32618 2.93469,-2.96272 v 0 -5.70443 c 0,-1.63654 -1.31397,-2.96508 -2.93469,-2.96508 v 0 z m -161.45955,0 c -1.62317,0 -2.93816,1.32854 -2.93816,2.96508 v 0 5.70443 c 0,1.63654 1.31499,2.96272 2.93816,2.96272 v 0 h 5.83491 c 1.62418,0 2.93885,-1.32618 2.93885,-2.96272 v 0 -5.70443 c 0,-1.63654 -1.31467,-2.96508 -2.93885,-2.96508 v 0 z m 111.02332,1.95856 c -2.93919,0 -5.32283,2.40223 -5.32283,5.36527 v 0 10.33144 c 0,2.96509 2.38364,5.36938 5.32283,5.36938 v 0 h 10.57151 c 2.93953,0 5.32111,-2.40429 5.32111,-5.36938 v 0 -10.33144 c 0,-2.96304 -2.38158,-5.36527 -5.32111,-5.36527 v 0 z m -65.67012,0 c -2.93817,0 -5.32216,2.40223 -5.32216,5.36527 v 0 10.33144 c 0,2.96509 2.38399,5.36938 5.32216,5.36938 v 0 h 10.5708 c 2.93781,0 5.32283,-2.40429 5.32283,-5.36938 v 0 -10.33144 c 0,-2.96304 -2.38502,-5.36527 -5.32283,-5.36527 v 0 z m 92.86472,7.99259 c -2.18592,0 -3.95779,1.79139 -3.95779,3.99834 v 0 7.68288 c 0,2.20729 1.77187,3.99184 3.95779,3.99184 v 0 h 7.86453 c 2.18456,0 3.9578,-1.78455 3.9578,-3.99184 v 0 -7.68288 c 0,-2.20695 -1.77324,-3.99834 -3.9578,-3.99834 v 0 z m -117.00486,0 c -2.18528,0 -3.95919,1.79139 -3.95919,3.99834 v 0 7.68288 c 0,2.20729 1.77391,3.99184 3.95919,3.99184 v 0 h 7.86208 c 2.18802,0 3.95987,-1.78455 3.95987,-3.99184 v 0 -7.68288 c 0,-2.20695 -1.77185,-3.99834 -3.95987,-3.99834 v 0 z m 140.24649,7.42285 c -1.62555,0 -2.94057,1.3272 -2.94057,2.96374 v 0 5.70443 c 0,1.63346 1.31502,2.9651 2.94057,2.9651 v 0 H 308.65 c 1.62072,0 2.93469,-1.33164 2.93469,-2.9651 v 0 -5.70443 c 0,-1.63654 -1.31397,-2.96374 -2.93469,-2.96374 v 0 z m -161.45955,0 c -1.62317,0 -2.93816,1.3272 -2.93816,2.96374 v 0 5.70443 c 0,1.63346 1.31499,2.9651 2.93816,2.9651 v 0 h 5.83491 c 1.62418,0 2.93885,-1.33164 2.93885,-2.9651 v 0 -5.70443 c 0,-1.63654 -1.31467,-2.96374 -2.93885,-2.96374 v 0 z m 180.73096,5.69999 c -1.22528,0 -2.22078,1.00103 -2.22078,2.23642 v 0 4.30358 c 0,1.23161 0.9955,2.23471 2.22078,2.23471 v 0 h 4.40293 c 1.22048,0 2.21526,-1.0031 2.21526,-2.23471 v 0 -4.30358 c 0,-1.23539 -0.99478,-2.23642 -2.21526,-2.23642 v 0 z m -198.56763,0 c -1.22461,0 -2.21872,1.00103 -2.21872,2.23642 v 0 4.30358 c 0,1.23161 0.99411,2.23471 2.21872,2.23471 v 0 h 4.40016 c 1.22494,0 2.2163,-1.0031 2.2163,-2.23471 v 0 -4.30358 c 0,-1.23539 -0.99136,-2.23642 -2.2163,-2.23642 v 0 z"\n         id="path836"\n         style="stroke-width:0.389833" />\n      <g\n         id="g1400">\n        <path\n           style="fill:url(#linearGradient1468);fill-opacity:1;stroke-width:3.05778"\n           d="M 167.92969,0.00281082 C 153.91385,0.06793434 140.52908,1.2632881 128.75185,3.3472609 94.057586,9.4765819 87.758461,22.305815 87.758461,45.965099 V 77.211816 H 169.74524 V 87.627382 H 87.758461 56.98953 c -23.827649,0 -44.691815,14.321798 -51.2178462,41.566738 -7.5277182,31.229 -7.8616278,50.71643 0,83.32456 5.8278802,24.2722 19.7457432,41.56673 43.5733922,41.56673 h 28.188922 v -37.45783 c 0,-27.06107 23.413862,-50.9312 51.217852,-50.9312 h 81.89123 c 22.79561,0 40.99339,-18.76918 40.99339,-41.66228 V 45.965099 c 0,-22.218887 -18.74415,-38.9096022 -40.99339,-42.6178381 C 196.55897,1.0027638 181.94549,-0.0623127 167.92969,0.00281082 Z M 123.59184,25.133957 c 8.46866,0 15.38447,7.02878 15.38447,15.671135 -3e-5,8.611724 -6.91581,15.575583 -15.38447,15.575583 -8.49904,0 -15.38446,-6.963859 -15.38446,-15.575583 -3e-5,-8.642355 6.88542,-15.671135 15.38446,-15.671135 z"\n           id="path1948" />\n        <path\n           style="fill:url(#linearGradient1465);fill-opacity:1;stroke-width:3.05157"\n           d="m 372.11228,194.486 v 36.33276 c 0,28.16828 -23.88128,51.87669 -51.11379,51.87669 h -81.72487 c -22.38583,0 -40.91011,19.15922 -40.91011,41.57764 v 77.9104 c 0,22.17374 19.28159,35.21609 40.91011,41.57764 25.89969,7.61553 50.73611,8.99185 81.72487,0 20.59855,-5.96395 40.9101,-17.96645 40.9101,-41.57764 v -31.18324 h -81.72486 v -10.3944 h 81.72486 40.91011 c 23.77924,0 32.64036,-16.58653 40.91008,-41.48229 8.54236,-25.6298 8.17888,-50.27698 0,-83.15527 C 437.85213,212.29592 426.62818,194.486 402.8187,194.486 Z m -45.96427,197.30308 c 8.48175,0 15.35321,6.94971 15.35321,15.54394 -3e-5,8.6248 -6.87146,15.63929 -15.35321,15.63929 -8.45151,0 -15.35321,-7.01449 -15.35321,-15.63929 0,-8.59423 6.9017,-15.54394 15.35321,-15.54394 z"\n           id="path1950" />\n      </g>\n    </g>\n  </g>\n</svg>\n'});function k(e){return p.createElement("span",{style:{display:"flex",width:"100%",justifyContent:"space-between"}},p.createElement("span",null,"Configure Slurm Wrapper"),p.createElement("a",{style:{color:"#1a0dab",textDecoration:"underline"},href:e},"Documentation"))}async function y(e,t){let n={};for(let e in t){let a=t[e];try{"slurm-provisioner"!=a.metadata.kernel_provisioner.provisioner_name&&(n[a.name]=[a.display_name,a.argv,a.language])}catch(e){n[a.name]=[a.display_name,a.argv,a.language]}}return new h(e,n)}async function b(e,t){const n=e.value;if(n&&(e.button.accept||e.button.save)&&await async function(e){let t={jobid:String(e.allocation||"None"),node:String(e.node||"None"),kernel_argv:e.kernel_argv,kernel_language:e.kernel_language,project:String(e.project),partition:String(e.partition),nodes:String(e.nodes),gpus:String(e.gpus||0),runtime:String(e.runtime),reservation:String(e.reservation||"None")};await c("configure",{body:JSON.stringify(t),method:"POST"}).catch((e=>{console.error(`Slurm-Provisioner: Could not save slurm-provisioner.\n${e}`)}))}(n),t){if(t.isDisposed||!e.button.accept)return;const a=t._session._kernel._name;n&&"slurm-provisioner-kernel"!=a&&await t.changeKernel(n)}}function x(e={}){return e.save=!0,a.Dialog.createButton(e)}class C{async selectKernel(e,t){var n;if(e.isDisposed)return Promise.resolve();const s=(t=t||i.nullTranslator).load("jupyterlab");let r=s.__("Cancel");e.hasNoKernel&&(r=e.kernelDisplayName);const o=[a.Dialog.cancelButton({label:r}),x({label:"Save"}),a.Dialog.okButton({label:s.__("(Re)Start")})],l=await d(),c=await y(l,null===(n=e.specsManager.specs)||void 0===n?void 0:n.kernelspecs),p=new a.Dialog({title:k(l.documentationhref),body:c,buttons:o}),h=await p.launch();await b(h,e)}async restart(e,t){var n;const s=(t=t||i.nullTranslator).load("jupyterlab");if(await e.initialize(),e.isDisposed)throw new Error("session already disposed");const r=null===(n=e.session)||void 0===n?void 0:n.kernel;if(!r&&e.prevKernelName)return await e.changeKernel({name:e.prevKernelName}),!0;if(!r)throw new Error("No kernel to restart");const o=a.Dialog.warnButton({label:"Restart"}),l=await(0,a.showDialog)({title:s.__("Restart Kernel?"),body:s.__("Do you want to restart the current kernel? All variables will be lost."),buttons:[a.Dialog.cancelButton(),o]});return!r.isDisposed&&!!l.button.accept&&(await e.restartKernel(),!0)}}function S(e){const t=e.translator||i.nullTranslator,n=()=>{e.dialogs.selectKernel(e.sessionContext,t)};return p.createElement(a.UseSignal,{signal:e.sessionContext.kernelChanged,initialSender:e.sessionContext},(e=>p.createElement(a.ToolbarButtonComponent,{className:"jp-Toolbar-kernelName",onClick:n,label:"Configure Slurm Wrapper",icon:w})))}class z{createNew(e,t){const n=new N(e),s=function(e,t,n){const s=a.ReactWidget.create(p.createElement(S,{sessionContext:e,dialogs:null!=t?t:a.sessionContextDialogs,translator:void 0}));return s.addClass("jp-KernelName"),s}(e.sessionContext,new C);return e.toolbar.insertItem(11,"Slurmel",s),e.toolbar.insertItem(11,"Countdown",n),new r.DisposableDelegate((()=>{s.dispose(),n.dispose()}))}}class N extends a.ReactWidget{constructor(e){super(),this.panel=e}render(){return p.createElement(E,{panel:this.panel})}}class E extends p.Component{constructor(e){super(e),this.state={date_show:!1,date_endtime:0,date_label:"Remaining time: "},this.props.panel.sessionContext.kernelChanged.connect(this._kernelChanged,this)}async _kernelChanged(e,t){let n=!1;if(t.newValue){const e=t.newValue._id,a=await d();for(let t in a.allocations)!n&&a.allocations[t].kernel_ids.includes(e)&&(this.setState({date_endtime:a.allocations[t].endtime,date_show:!0,date_label:"Remaining time ( allocation "+String(t)+" ): "}),n=!0)}this.setState({date_show:n})}render(){const e=p.createElement(v,{key_:"timer",date_label:this.state.date_label,date_endtime:this.state.date_endtime,date_show:this.state.date_show});return p.createElement("div",{style:{alignSelf:"center"}},e)}}var D;!function(e){e.create="create-react-widget"}(D||(D={}));const j={id:"slurm-provisioner-configurator",autoStart:!0,requires:[i.ITranslator],optional:[s.ILauncher,a.ICommandPalette],activate:function(e,t,n,s){var i;const{commands:r,serviceManager:o}=e,l="Slurm",c=t.load("jupyterlab"),p=D.create,h=null===(i=o.kernelspecs.specs)||void 0===i?void 0:i.kernelspecs;let m={};for(let e in h){let t=h[e];try{"slurm-provisioner"!=t.metadata.kernel_provisioner.provisioner_name&&(m[t.display_name]=t.argv)}catch(e){m[t.display_name]=t.argv}}r.addCommand(p,{label:e=>e.isPalette?c.__("Configure slurm wrapper"):c.__("Configure Slurm Wrapper"),caption:c.__("Configure slurm wrapper"),icon:e=>_,execute:async()=>{var e;let t=c.__("Cancel");const n=[a.Dialog.cancelButton({label:t}),a.Dialog.okButton({label:"Save"})],s=await d(),i=await y(s,null===(e=o.kernelspecs.specs)||void 0===e?void 0:e.kernelspecs);(0,a.showDialog)({title:k(s.documentationhref),body:i,buttons:n}).then((e=>b(e,null)))}}),n&&n.add({command:D.create,category:l,rank:9}),s&&s.addItem({command:p,category:l,args:{isPalette:!0}}),e.docRegistry.addWidgetExtension("Notebook",new z)}}}}]);